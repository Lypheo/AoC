import math
import time
from datetime import datetime
import time
import functools, itertools, collections, re
from math import ceil, prod, gcd

import numpy as np
from aocd.models import Puzzle
from aocd import submit
from pprint import pprint

day = 20
puzzle = Puzzle(year=2020, day=day)

input_data = ""

def test(tests, solution):
    for i,o in tests.items():
        if (ao := solution(i)) not in o:
            print(f"Testcase failed!\nExpected output:\n    {o}\nActual output:\n    ", end="")
            pprint(ao)
            return False
    print(f"Tests successful!")
    return True

def solve_a(inp=input_data):
    tiles_r = inp.split("\n\n")
    tiles = {}
    for x in tiles_r:
        id, t = x.split(":\n")
        tiles[int(id.split()[1])] = t

    borders = collections.defaultdict(list)
    for id, t in tiles.items():
        rows = t.split("\n")
        borders[id].extend([rows[0], rows[-1]])
        l, r = "".join(r[0] for r in rows), "".join(r[-1] for r in rows)
        borders[id].extend([l, r])

    all_borders = sum(borders.values(), [])

    o = 1
    for id, bs in borders.items():
        if sum(all_borders.count(b) + all_borders.count(b[::-1]) == 1 for b in bs) == 2:
            o *= id
    return o

cprod = itertools.product

def solve_b(inp=input_data):
    tiles_r = inp.split("\n\n")
    tiles = {}
    for x in tiles_r:
        id, t = x.split(":\n")
        tiles[int(id.split()[1])] = t

    borders = collections.defaultdict(list)
    for id, t in tiles.items():
        rows = t.split("\n")
        borders[id].extend([rows[0], rows[-1]])
        l, r = "".join(r[0] for r in rows), "".join(r[-1] for r in rows)
        borders[id].extend([l, r])

    all_borders = sum(borders.values(), [])

    def rotate(bs, d = 90):
        if d == 90:
            return [bs[2][::-1], bs[3][::-1], bs[1], bs[0]]
        elif d == 180:
            return rotate(rotate(bs))
        elif d == 270:
            return rotate(rotate(rotate(bs)))
        else:
            return bs

    def flip(bs, flip):
        if flip:
            return [bs[1], bs[0], bs[2][::-1], bs[3][::-1]]
        return bs

    w = int(len(tiles)**(0.5))
    grid = {}
    for y,x in cprod(range(w), range(w)):
        missing_edges = [y == 0, y == w-1, x == 0, x == w-1]
        for id, bs in borders.copy().items():
            for d,h in cprod([0, 90, 180, 270], [True, False]):
                rot = flip(rotate(bs, d), h)
                medges = [all_borders.count(b) + all_borders.count(b[::-1]) for b in rot]

                if all(j == 1 if i else j > 1 for i,j in zip(missing_edges, medges)):

                    wb = lambda x: 0 <= x < w
                    if wb(x-1) and grid[(y, x-1)][1][3] != rot[2]:
                        continue
                    if wb(y-1) and grid[(y-1, x)][1][1] != rot[0]:
                        continue
                    grid[(y, x)] = [id, rot, (d,h)]
                    break
            if (y, x) in grid:
                del borders[id]
                break

    def flip2(t, b):
        return t[:: {True:-1, False: 1}[b]]

    def rotate2(t, d = 90):
        if d == 90:
            width = len(t)
            return ["".join(t[y][x] for y in reversed(range(width))) for x in range(width)]
        elif d == 180:
            return rotate2(rotate2(t))
        elif d == 270:
            return rotate2(rotate2(rotate2(t)))
        else:
            return t

    tw = len(tiles.values().__iter__().__next__().split("\n")[0]) - 2 # I hate myself.
    image = [[None for i in range(tw*w)] for j in range(tw*w)]
    for pos, (id, bs, (rot, f)) in grid.items():
        tile = [k[1:-1] for k in tiles[id].split("\n")[1:-1]]
        t = flip2(rotate2(tile, rot), f)
        for x,y in cprod(range(tw), range(tw)):
            image[pos[0]*tw + y][pos[1]*tw + x] = t[y][x]


    seamonster = """                  # 
#    ##    ##    ###
 #  #  #  #  #  #   """

    image = ["".join(row) for row in image]
    import regex
    for d,f in cprod([0, 90, 180, 270], [True, False]):
        image2 = flip2(rotate2(image, d), f)
        sm_regex = seamonster.replace("\n", f".{{{len(image2[0]) - 20}}}").replace(" ", ".")
        imageS = "".join(image2)
        if o := len(regex.findall(sm_regex, imageS, overlapped=True)):
            return imageS.count("#") - o * seamonster.count("#")


tests = {
"""Tile 2311:
..##.#..#.
##..#.....
#...##..#.
####.#...#
##.##.###.
##...#.###
.#.#.#..##
..#....#..
###...#.#.
..###..###

Tile 1951:
#.##...##.
#.####...#
.....#..##
#...######
.##.#....#
.###.#####
###.##.##.
.###....#.
..#.#..#.#
#...##.#..

Tile 1171:
####...##.
#..##.#..#
##.#..#.#.
.###.####.
..###.####
.##....##.
.#...####.
#.##.####.
####..#...
.....##...

Tile 1427:
###.##.#..
.#..#.##..
.#.##.#..#
#.#.#.##.#
....#...##
...##..##.
...#.#####
.#.####.#.
..#..###.#
..##.#..#.

Tile 1489:
##.#.#....
..##...#..
.##..##...
..#...#...
#####...#.
#..#.#.#.#
...#.#.#..
##.#...##.
..##.##.##
###.##.#..

Tile 2473:
#....####.
#..#.##...
#.##..#...
######.#.#
.#...#.#.#
.#########
.###.#..#.
########.#
##...##.#.
..###.#.#.

Tile 2971:
..#.#....#
#...###...
#.#.###...
##.##..#..
.#####..##
.#..####.#
#..#.#..#.
..####.###
..#.#.###.
...#.#.#.#

Tile 2729:
...#.#.#.#
####.#....
..#.#.....
....#..#.#
.##..##.#.
.#.####...
####.#.#..
##.####...
##..#.##..
#.##...##.

Tile 3079:
#.#.#####.
.#..######
..#.......
######....
####.#..#.
.#...#.##.
#.#####.##
..#.###...
..#.......
..#.###...""" : (20899048083289, 273),
"""Tile 1237:
######..#.
...##.#..#
....#..#..
.#.#......
#..##.....
#.#..#..#.
......#..#
#.....#...
..........
..#.#.....

Tile 2113:
.##.####.#
.##.#.#.##
#....#...#
........#.
##.##.#.##
..#.#.....
#.##....#.
.##.......
.......#.#
##..##.#..

Tile 3089:
....###..#
##...#..#.
.....#.#..
...#.....#
..........
#........#
##.##..#.#
....###...
#.#....#..
#####..#..

Tile 1217:
#..#...###
#.#.......
.......###
#.........
....#....#
#..#....##
#.......##
#........#
#.#..#..#.
##....##.#

Tile 2129:
.###.##.##
##.......#
#....#....
#......#.#
#..#.#..##
#.......#.
##....####
..#.....##
#........#
...##.####

Tile 1861:
##.##..#..
...#.#...#
#....#....
......##.#
...#.....#
.........#
##....#...
##...#....
.#...#.##.
#.#.###...

Tile 3907:
.#.#.#...#
........##
##.......#
#......#..
#......##.
..#......#
#.#..#....
...#....#.
.......#..
.#.####.##

Tile 1549:
##.#......
....#.#.##
...#.....#
..........
..#......#
...##....#
..........
#.......#.
##...#...#
.###.##..#

Tile 2699:
..####...#
.##.#..###
..#..##.##
#.#.#...##
#.....#...
#.......##
###...#..#
.....#....
#........#
.#.###....

Tile 2593:
.#....#...
....#.#...
....##....
##...#...#
...#....##
#...#..#.#
..##.#..#.
..####....
.#..#..#..
...###.##.

Tile 3209:
.#..#....#
.....#...#
#.........
..........
#.........
.....#..#.
#.........
##........
..#.......
#.#.....##

Tile 1789:
###..#..#.
#.#..##.##
#...##...#
#.........
..#.#.....
..####..##
#.#..###..
......####
#....####.
..##.#..##

Tile 2111:
#.##.#.###
.#..#....#
.#.#..#...
#.......#.
.......#..
#......#.#
#.........
.....#...#
##.....#..
..##.#..##

Tile 3137:
.####..##.
##.##....#
#....#....
#.........
..#...#.#.
#.#..##.#.
..#...#..#
..#..#.#.#
.......###
#.##...###

Tile 1871:
#.####....
#....#....
......#..#
#.......##
##.#....##
..#..#....
#..#...#..
#.#...#.##
#.##.....#
.##.....##

Tile 3119:
######.##.
..#..##..#
.......##.
#...#.#..#
..#...#...
#..#....#.
#....#....
#......#.#
#.........
......#.##

Tile 1579:
.#.#.#....
#..#.....#
###.....#.
..#.#....#
####......
#.#......#
.......#..
...#.....#
.#####...#
#..#....##

Tile 1249:
#...####..
#.........
...#.....#
#......#.#
....##....
#..#..##.#
#..#.....#
....#.#...
#.#....#..
.##...#.#.

Tile 1319:
....#.####
#.#..#.#.#
#......#..
..#.#.#..#
..#....#.#
##....#.#.
###...#...
###......#
..#..#..##
..#.#..##.

Tile 1987:
.#...####.
...#...###
...##...##
..#..#..#.
##.....#..
#..#....##
.#.....#.#
#......#..
##......#.
..###...#.

Tile 2963:
.##.#####.
#.##...##.
#..##.....
..#......#
..##.....#
.#..#..#.#
..........
#...#..##.
...#......
##..#####.

Tile 1609:
..##..###.
.....#..#.
.....#....
##....#...
###..#...#
##....#..#
......##..
..#..###..
#....#.#..
...##....#

Tile 2267:
...#.#..#.
..##....##
####..#.##
....#.##.#
##..#.....
..##.#....
#.##...###
#..##.###.
..........
..#..##...

Tile 1531:
#.#..##..#
#........#
#.....####
....#...##
#.....##.#
#.........
......##.#
.#.#..#..#
.........#
#..#.#.#.#

Tile 2357:
.......#..
...#..#...
.......#..
.#...#.###
#.####...#
.#.#.....#
#.#.....#.
.###..##.#
#.#.#...#.
##.#.#####

Tile 1373:
.#.....###
..#...##..
..#......#
...#...#.#
.#..#.#..#
......#...
#...##..#.
#...#..##.
...#......
##.#.#...#

Tile 3373:
...##.#.##
#.........
....#....#
#..###...#
#...#...##
......#.##
........#.
.......##.
#..#...#..
.##..#.#..

Tile 1831:
...#####.#
#........#
#.....#..#
#.#...###.
...#.##..#
..##.....#
..#....#..
......##.#
##...#....
##.###.#.#

Tile 3607:
#...#.#...
.#...##.##
.#.......#
..####....
####....#.
.#.#...#.#
###...##..
#......#..
###.#..#.#
##.##..###

Tile 3251:
##.#..##..
.#....##.#
#.......#.
..#..#..#.
#..##....#
#...##..##
.....#..##
...#...##.
....##....
#####...##

Tile 3917:
.##.......
.#..#...#.
....##...#
#.#..##.##
.#.#...#..
..#.......
.....#..#.
.#..#.#..#
...##..#.#
##..#...##

Tile 1489:
.##..##.#.
##...#.#.#
#.......#.
##.#.....#
.#...##..#
..#.......
.#..#....#
###..#..##
#..##.....
#######...

Tile 3253:
#..#..####
....#..#..
#.##..#...
.##....###
........##
..........
#...#.....
##...#...#
...##.....
.##..##.#.

Tile 2081:
.......##.
#...#....#
#..#....##
##....##..
#.#.###...
.....#....
#...###.##
##..##....
#........#
.#...#..#.

Tile 1481:
######..#.
###.#....#
.....#...#
#.........
#..#....##
#........#
..........
#...#....#
#..#.##...
#####..##.

Tile 2953:
..##.#####
#.#..#..##
..#....#.#
#...#.#...
#..##....#
#.#....#.#
.......#.#
#..##.....
#.#.....##
...##..#.#

Tile 1783:
.#..#.#.##
#...#....#
...#......
#.#.#..#.#
.........#
......#...
.#...#..##
..#...#.#.
#..#..#..#
...#..#.##

Tile 2269:
#.#.##..#.
#.....##..
.#.......#
..#..#...#
....#.....
..........
##.##....#
.....#....
##.....###
.#.#####.#

Tile 1277:
..##..#...
#...#.....
.......#..
...#......
....#....#
..#.......
#......#..
.#........
#.........
###.###...

Tile 2633:
####.#.#..
......#.#.
........#.
#.........
...#...###
...#.....#
.##.#..#.#
.#........
#.#......#
.##.##.#.#

Tile 3919:
###..###..
...#......
...##.#..#
#...#..#.#
.........#
...#.#.#..
...#.#....
#....#...#
.#.###..##
.#.#.##...

Tile 1753:
#...##....
#.....#...
..........
.#..#.....
#.......##
..#.......
......#..#
#..####...
....#..#.#
..#.####..

Tile 3739:
.##.#.#..#
###.##.##.
##.###.#..
.#....#..#
#...##....
#..#......
#....###.#
..#.......
###....#.#
...###..#.

Tile 3701:
.####..#.#
#.....#...
.#........
.........#
...#.#....
#.#.......
#...#....#
.###.#.##.
#.#.......
##.##..##.

Tile 3631:
#..#..###.
.........#
#...##....
.......#.#
.....#....
...#..#..#
........#.
..#....#.#
......#...
##.#..#.#.

Tile 2389:
..#.##...#
###.......
#..##...##
#.######..
..#..##...
.#...#...#
.....#...#
#..#....#.
..#...##..
#...#..##.

Tile 1123:
.##.#.###.
#........#
#.........
#.....##.#
....#.....
....##.#.#
....#....#
#.#.#..#.#
#..#.....#
#.#..#..#.

Tile 2659:
#.##.#.##.
.#........
#....#..##
###..##.##
#.#.###..#
#...##...#
...#...#..
...#..#...
..#.#.#..#
####...#..

Tile 3709:
.##...#.##
..#..##..#
......#.##
......#..#
....#.....
..........
#......#.#
#....##..#
.....##..#
####.##...

Tile 2887:
######..##
#.........
.......#.#
...#.#....
#....##...
#...#....#
...#.#...#
#....#...#
##....#..#
#########.

Tile 1367:
#.####.###
#......#.#
..........
#....#....
.#......#.
#.........
...#.#.#..
......#...
##....#...
.....##.##

Tile 2221:
##..#.....
#.....#...
.........#
#..#......
#.#...#...
###......#
...#.....#
#........#
#.....#...
..##.###..

Tile 2621:
##..#.###.
.......###
.........#
..#.#...#.
..........
....#.....
#.##..##..
......#..#
....#...#.
##.#.....#

Tile 2503:
..#.##.##.
......#...
#.#..#....
....#....#
#.....#...
..#......#
##...#..#.
#....#..#.
...#......
#....####.

Tile 3491:
#..#.###..
#.........
#..#..#..#
###....###
#.#.##....
#........#
......#...
##...#...#
##........
.#.#.##.##

Tile 2333:
..##.....#
.....#..#.
#.#.#..#.#
##.##...#.
..#.#.....
...#.....#
..###..#..
###.....##
#........#
##.####.#.

Tile 2399:
.....#.##.
##.....#.#
##.......#
.#.#..##.#
#...##...#
###.#....#
#......#..
##......#.
#.#....#..
.....#.#..

Tile 2683:
#.##..##..
.#....#..#
.........#
.......#.#
.##.#..##.
.....##..#
#....##..#
....##.#.#
...###.###
.#.##.#.##

Tile 1741:
.##..#.#.#
.##....#..
##..#.....
##...###..
......#..#
#.....#...
.......#..
#.....#...
...##..#.#
#..###.##.

Tile 3539:
.###....##
..........
.##.#...#.
.....#...#
.........#
.........#
.......#..
..#.....#.
.#.#.###.#
#.#.####.#

Tile 3929:
##..######
.#..##.###
#.##....#.
...##..#.#
#...#.....
........#.
.....#...#
#...#.#..#
.#.#.....#
..##.#..#.

Tile 3221:
..####..#.
##......#.
..#..#.###
##........
....#....#
.#...#...#
#.#...#..#
##....#..#
##......#.
.#..#..##.

Tile 1117:
.##.##.#.#
##.....###
#.#.#.##..
..#....#..
##....#...
...#..##.#
..#.#.#..#
...#...#.#
....##...#
.###.#..##

Tile 3163:
.####.#.#.
#.........
..........
......#..#
....##.#..
.#....#..#
.....####.
#....#.#..
...#.#..##
##.#.#....

Tile 1129:
.....##...
##......##
#..#..#..#
..#....#..
#.#...#...
....#.##..
...#...#..
#.........
#..#..#.#.
#.#..###.#

Tile 3079:
###..#.##.
....###...
##..#....#
....##...#
......##..
....#....#
#.#.#.....
#...#....#
.#........
.##.#.###.

Tile 2039:
.#.#.##..#
..##......
.##.......
#.........
....#...##
#..#.#...#
..........
#.....#..#
####..#..#
.#..#..##.

Tile 1901:
####.#.##.
#.#...##..
...#....##
..........
#.........
#...##...#
..........
##......##
.#.....#..
.###.##...

Tile 2029:
####..##..
##...#....
.#....##.#
..#....##.
#........#
..........
..........
#..#..#...
#..#....##
....####..

Tile 1879:
##..#.##.#
#...#...##
.##...#.##
.#.#.....#
.##.#..#.#
#..##.....
#..##...#.
......#.##
...#..#..#
#....#..#.

Tile 3347:
###..#..##
.#..#....#
.#...#...#
....#....#
.#......##
......##.#
.....#..##
.........#
#......#..
.####.#..#

Tile 2417:
####.#..##
...#.#....
.#....#..#
.#........
#.........
.....#....
#..##.....
#..#...#.#
#..#.##..#
..##..####

Tile 2897:
...#..#.##
#.#.......
.........#
#.#.#..#..
..#.......
.........#
.##...#..#
....#..###
.###...##.
.#.#.#.#..

Tile 2837:
.#....###.
.......#..
......#..#
#..#..#.##
#.#.##...#
#...#....#
...##.#.#.
#.....#..#
#.#.....#.
#####.####

Tile 3001:
##....#..#
#....#.#..
.....##..#
.....##..#
...#......
#.....#..#
#.#...##.#
.#...#...#
........#.
###.####.#

Tile 2153:
.####.##..
#..#.....#
..#....#..
#......#.#
.........#
.###.....#
#.##.....#
#..#......
#.#.......
.######..#

Tile 2749:
..##.###..
#..#...#..
..##.....#
###.......
#..##.....
......#..#
..#..##...
.###.....#
#.#.......
...#..#..#

Tile 2791:
..##.##.#.
.##.###.#.
.#..#....#
.##..#.#.#
#..#....#.
......##..
#.##.#.#.#
##...#.##.
.#...#.#..
...#.#...#

Tile 2707:
..###...##
.#....#...
..#...##..
#.#.......
....#....#
#.....#...
.........#
##.....###
#........#
#.##.#####

Tile 2969:
..#####..#
..........
#.....#..#
....#.#..#
...#......
..##.#...#
...#.#....
...#.....#
..#.......
####..##.#

Tile 3329:
#.###..#..
...#....#.
........#.
.........#
###.#..#.#
.#.......#
.........#
.......#..
#....##..#
##.###.#..

Tile 3989:
.#####.###
#....#.#..
.........#
.........#
##.#...#.#
......#..#
...#.....#
###......#
.#.......#
.###.##.#.

Tile 3583:
..#..#.#..
.#........
###...##..
##.....#..
##.......#
#.........
#.........
#...#..#.#
##.#......
#.........

Tile 3931:
....#..#..
#.#.#.....
..#..#..#.
.##...##.#
.......#.#
.........#
....#...##
......#..#
#.#....#..
#.#.#.##.#

Tile 1493:
####..##.#
..........
....#..#..
##...####.
#.........
#.........
.#.#.....#
....##...#
......##..
.#########

Tile 1013:
#.###....#
....####.#
...#.####.
.......##.
.#..#....#
#.........
#......#..
...#...#..
#.....#...
#.#.#####.

Tile 2089:
.#...#.##.
..#...#..#
........#.
...#.#..#.
.....##..#
#...###...
#....#.#..
#....#..#.
#...###..#
........##

Tile 1613:
#.#...####
#.....#...
#....##..#
#....#....
.#....#...
#........#
......#.#.
#.....#...
##...#...#
....#..##.

Tile 3331:
.#.#.#####
.....#...#
.......#..
##..#...#.
#........#
......#..#
..#.#....#
.......#..
..#.......
###.###..#

Tile 3217:
..#.###...
#.##......
..#...##..
...#.##..#
###...###.
#...#.#.#.
##.#...#..
.........#
.....##...
##.###....

Tile 3011:
#.##.#....
....#...##
..........
#........#
#....#...#
#..#......
..........
.........#
....##....
##.####...

Tile 1171:
###..###.#
..#.....##
##.#...#..
.#.......#
..........
##.....##.
.##.....##
..#...####
##.##..#.#
#.#.#.#...

Tile 1933:
#####..#..
#.#.#.#...
#.#.......
#.#.#.....
.....#...#
#.#.......
..........
...#..#...
.##....#..
......#...

Tile 2141:
#.###...#.
#.....#...
.........#
.....#..#.
#.###.....
#..###.#..
.....#..#.
....#....#
.#.......#
...##..##.

Tile 1031:
###...#..#
#.......#.
##.#..#..#
##..#.....
#...#.....
##....#...
#......##.
#.........
......#..#
....#..##.

Tile 2857:
#.#..#...#
#........#
##.#..#.##
....#.##..
....#...##
#...#.....
#..#......
.......###
#...####.#
.#...####.

Tile 3313:
.#......##
...##.....
.#.##.....
#.#.#.....
#.#..#....
..#.......
#..#.#...#
#.#......#
##...#....
..###.##.#

Tile 1303:
#.##.#....
#.......##
...#...##.
....##...#
.....#...#
.........#
#..#...#.#
##...##...
...#.#.#..
....##..##

Tile 3457:
#...#.#..#
.........#
#.#..#...#
.....#.#..
........##
...#......
..##.##...
..........
....#....#
#...#..#.#

Tile 3643:
##.##..###
..#.#....#
..##.....#
..#.......
#.........
#.........
#.......#.
......#..#
.#......#.
.###..##.#

Tile 2803:
#...#..##.
##....#.##
.#.......#
#...###...
#...###..#
#..#......
.......#.#
#.......#.
...##.....
..#..##.##

Tile 2549:
.#....####
.#........
.....###..
.....#..##
..#.###...
......#...
.........#
.......##.
#......#.#
..###.####

Tile 3571:
#..#.##...
...#....#.
..##..##..
....#.##.#
.#.....#..
.##...#...
.##......#
#.#......#
......#...
.#..#..#..

Tile 1327:
#..###...#
#....#...#
#.##...#.#
#.......#.
#.#...#..#
.........#
##........
....#..#..
.....#..#.
.#.###..##

Tile 2833:
##...#..#.
##....#..#
##.#.....#
.......#..
###...#..#
.........#
#.#....###
....##.#..
..#...#...
..#.#.#.##

Tile 1997:
##..#...##
#...#.....
#.....#...
.......#..
.......#.#
#.........
#......#..
.........#
..#.#.#..#
.###.##..#

Tile 3673:
..#..###..
.#..##....
#.##.....#
.####..###
##..#..#..
#.#.#...##
.#....#.#.
....#.##..
#...#....#
..#.##....

Tile 3323:
.#...#####
#..#...#.#
..........
#....#...#
.#........
#........#
##......##
...##...#.
...#.#..##
#.##.###.#

Tile 1619:
#..###.###
#...##...#
.#........
#.#.....#.
#.##.....#
#......#..
.......#..
#####.#..#
..........
####...#..

Tile 2477:
.##.##..#.
#.#.#.....
......#..#
......#.#.
##.##.....
.###.#..#.
.........#
...#.#....
#.....#...
...##.#...

Tile 3389:
#...#.#.##
##.#.....#
......#..#
#..#.#...#
#....#..#.
##......##
....#...##
#.##..##..
#........#
...##.#.##

Tile 1193:
.##...###.
#...##..#.
###.......
#.#..#....
.#..#.#...
#..##....#
#.#..##...
####.....#
#...#..#..
..##.....#

Tile 3767:
#...#.....
...#.#..#.
#######...
...#.#....
#.........
.#....##..
#.#.......
.#.#.#..#.
..#.###..#
....##.#..

Tile 3191:
#.##...#..
..........
......####
#..#..#...
....#.#.##
......#.#.
.....#....
.#....##.#
..#..#.#.#
#...##.#.#

Tile 3049:
#...#...#.
.#..#....#
##.#.....#
...#...##.
#.##.....#
.....#.#..
..##..##..
..........
#....#.#.#
#.##.#..#.

Tile 1747:
###....#..
....#..#.#
.......#..
........#.
#..#......
.......###
...#.##...
.....#..##
.#....#...
.##..####.

Tile 1429:
...#.#.#..
.#...#....
..........
##........
#.........
#..#.#....
.##.......
.#........
.##.#.#..#
#####.##.#

Tile 2909:
#.##.###..
#..#.....#
#...#.....
.#..#.##..
#.#.....#.
#...#...##
...#...#..
.##.....##
##..#..#.#
#.###..###

Tile 1973:
#####.#.#.
...#.....#
#.........
#........#
.....###..
..........
.#.....#.#
.##..#.##.
##.#..#...
#.##...#.#

Tile 3449:
.#.#.#..#.
#...#.#...
..#.##....
#...###...
.....#...#
#.......#.
##....#.##
......#..#
#.......#.
..####....

Tile 3371:
##.#..#.#.
#...##...#
##...##...
.#....#...
#...##...#
..#......#
......#..#
##.###...#
#....#...#
.##....#..

Tile 1103:
####..#..#
.......#..
#......#.#
..........
.#....##..
.#.##...##
##....##.#
..#..#.###
..........
.#.#...#.#

Tile 1723:
.#....###.
...#.#...#
..#.#.....
#####....#
.#.#......
....#..#..
..#.......
..##...#.#
....###...
...##.#.#.

Tile 1093:
..##.#.###
.##.......
#....#....
.#.....#..
#.......##
.........#
.#......##
#......#.#
#..#.#...#
#.#####.#.

Tile 1321:
#.#.###.#.
.#..##..#.
#.###..#..
#..##....#
#.......#.
....#....#
#....#...#
.....#....
#.###.....
.###...##.

Tile 1979:
#####.###.
#.#..#..#.
#.####....
###.....##
....#.....
#.........
###.#..#.#
..##...###
#.......##
..#.......

Tile 2677:
##..#.##.#
#.##.....#
#..#...#.#
..#.#.#..#
##.#..#..#
.....#..#.
#...#...##
...#...###
##.#...#..
.###..##..

Tile 1553:
.#...###..
.........#
###.......
##..#...#.
..#...##.#
..##......
.##.......
...#..#...
#....##...
#####.#...

Tile 3187:
###..#..#.
#.....#...
.....#..##
#.....#..#
..#......#
##...#....
......##.#
......#...
#.#..#....
########.#

Tile 2243:
##.####...
..#.#.#..#
#..#......
.........#
....#...##
#.........
#......#.#
....#....#
......#.##
##.#....#.

Tile 1423:
..#..##..#
..#....#.#
#.#.....##
##.......#
.#..#..#..
......##..
##...##...
.....##..#
...#.#.#.#
##...###..

Tile 3319:
##.##.#.#.
#.......#.
....#.....
###....###
........#.
###.......
.#.....##.
#...#....#
..#.......
.##...####

Tile 3343:
.#...#####
..........
.###...#.#
.##.......
..........
##....####
#......#.#
#.#.###..#
..#.......
.#####..#.

Tile 2789:
##....####
.##.......
#......#.#
.#.##.....
#......#.#
#........#
##......#.
.#...##...
#.....##.#
...###.#..

Tile 3623:
##..#..#.#
#.....#.#.
##.....#.#
.#...##..#
.#.......#
..#...#..#
.#..#..##.
###..#.###
.#.##.#..#
.#.##.#.#.

Tile 1439:
.#..#.#.#.
....#.....
.........#
#..#......
##..#....#
#.#.#.##..
##.#.#...#
#.........
#.......#.
####...#.#

Tile 1361:
#.#...###.
#.........
....#.....
..#.......
......#..#
##....##.#
.##..#..##
..#......#
.....##..#
#..#....#.

Tile 1823:
.##.#.#...
#.........
#..#.##.#.
#...##....
##........
#...#.#.##
#........#
.........#
........#.
#.###...#.

Tile 2971:
.#.......#
#.#....#..
#..#.#....
...#..#...
##....#...
#..#......
.........#
....##....
#...###..#
#...#.#.#.

Tile 3229:
..###.####
#........#
.#.......#
..........
##.......#
#..#......
.#.#......
#.....##.#
.#......#.
.#####.#.#

Tile 1907:
####.#.#..
....#....#
#....#....
#.........
#...#..###
...#.#.#.#
....##....
#.###..###
..#..##.##
..##.##...

Tile 1699:
..#..##...
.#..#.#...
.....#...#
.#.#.#...#
........#.
##.....#..
#.#......#
.##......#
....###.#.
...##..###

Tile 2131:
#..#####..
#....#...#
#..####..#
......#..#
#.#..#...#
#.#...#..#
..##......
#.#####..#
......#..#
#...####.#

Tile 1657:
..#..##.#.
#....##...
##..#....#
#........#
#.........
#.......##
#......###
#.#.#...##
........##
#.##.#.##.""": (1665,)
}


# a = solve_a()
# print(f"Part 1: {a}\n")
# test(tests, solve_a)
# submit(a, part="a", day=day, year=2020)

b = solve_b()
print(f"Part 2: {b}")
# test(tests, solve_b)
# submit(b, part="b", day=day, year=2020)
#
# t1 = time.time_ns()
# for i in range(times := 5):
#     solve_a()
# t2 = time.time_ns()
# print(f"Part 1: {(t2-t1)/(1000000*times)} ms")

# t1 = time.time_ns()
# for i in range(times := 100):
#     solve_b()
# t2 = time.time_ns()
# print(f"Part 2: {(t2-t1)/(1000000*times)} ms")