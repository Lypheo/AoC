import time
import functools, itertools, collections, re
from aocd.models import Puzzle
from aocd import submit
from collections import defaultdict as dd
from itertools import *
from pprint import pprint
import sys
sys.path.append("..")
from aocl import *
day = 22
puzzle = Puzzle(year=2022, day=day)
input_data = puzzle.input_data

def solve_a(inp=input_data):
    # inp = inp.splitlines()
    map, pathr = inp.split("\n\n")
    grid = {}
    for y, row in enumerate(map.split("\n")):
        for x, tile in enumerate(row):
            if tile == " ":
                continue
            grid[complex(x, y)] = tile

    path = []
    i = 0
    while i < len(pathr):
        if pathr[i:i+2].isnumeric():
            path.append(int(pathr[i:i+2]))
            i += 2
        else:
            t = pathr[i:i+1]

            path.append(t if not t.isnumeric() else int(t))
            i += 1

    dir = complex(1, 0)
    pos = complex(min(c.real for (c, tile) in grid.items() if c.imag == 0), 0)
    rots = {"R": 1j, "L": -1j}
    for ins in path:
        # print(dir, pos, ins)
        if isinstance(ins, int):
            for i in range(ins):
                if pos + dir not in grid:
                    if dir == 1:
                        newpos = min(c.real for (c, tile) in grid.items() if c.imag == pos.imag) + pos.imag * 1j
                    elif dir == -1:
                        newpos = max(c.real for (c, tile) in grid.items() if c.imag == pos.imag) + pos.imag * 1j
                    elif dir == 1j:
                        newpos = min(c.imag for (c, tile) in grid.items() if c.real == pos.real)  * 1j + pos.real
                    else:
                        newpos = max(c.imag for (c, tile) in grid.items() if c.real == pos.real)  * 1j + pos.real
                    if grid[newpos] == "#":
                        break
                    else:
                        pos = newpos
                elif grid[pos + dir] == "#":
                    break
                else:
                    pos += dir
        else:
            dir *= rots[ins]

    return (pos.real + 1) * 4 + (pos.imag + 1) * 1000 + {complex(1, 0): 0, complex(0, -1): 1, complex(-1, 0): 2, complex(0, 1): 3}[dir]

input_data2 = """                                                  ......#....#.#........................................#.......##...........#.............#......#...
                                                  ..............#..#........#......##........................#......#....#........................#...
                                                  .....................#.........#...#.#........#..............................#....#........#..#.....
                                                  .........#.........##................................#.....#.........#...........#...........#......
                                                  ..........#.............#.....##.......#..#..........##......#.#...........#............##..........
                                                  ......#.............##.........#.....#....#...............................................#.......#.
                                                  ..#......#......#.........#..#.........#....#...................#...........#...#.....##.#..#...#..#
                                                  #.#.............#.............#.#......#.....#.....#.##.##.....#...#..#...............#.............
                                                  .#....#...##....#...................#..#............................................#.........#.....
                                                  ....#..##....#..#....#..............#..#...#...#................#...........#..#..#............##...
                                                  ..#.#....................................................................#.....##....##.....#..#....
                                                  .......#...#......#...##........#...#......................#.#.#..............#...#..#.....#........
                                                  .....#.#..#........#..............##......#........##...............#..................#.....#......
                                                  .......#...............#...#...................................#............#.......................
                                                  ......#..##.....#.......#....#..................................................#.#.......#.........
                                                  ................#..#..#....#.#.....................#................................................
                                                  .................#.#........#.....##...#...#.#..#....#....#.............#...#..................#..#.
                                                  .#...................#......#..#...............#.............#.........................#...#.....#..
                                                  ...#.#...................#...#.........................#.......##.......................#.........#.
                                                  .#.............................#........##.........#.#.....##.....................#....#...........#
                                                  ..........#.....#..............................#................##.....................#.......#....
                                                  .....................................#....##..........#...............#.......##.........#.#........
                                                  ....#.###............#....#..........#..........#.......................#...............#....#.#....
                                                  .#...#...#...............#.........#........................#.................#..................#.#
                                                  .................#......#.....................#........#......#.....................#....#.##.......
                                                  ##..#....................#.....................#....#....#.....#.............................#.....#
                                                  #...#.......................................................##.#...#.........#..#...................
                                                  ............#......#.....#........#..#.#......#.#.............#....#......#.#...............#.......
                                                  ..................................................#.#..........##.........##......#.#.#.........##..
                                                  ..#..........................#.......#..#..#.......#.................###.......#...........#..#...##
                                                  ..#.....#..#...#.....#.....#...#..#.................................#.....#.........#.............#.
                                                  ............#.#..#..##..#.#.##....#...............#.......#........#............#........#..........
                                                  .#...........#...........................#............#.....#.#.........#.....#.......###...#.......
                                                  ...#.......................#.........................#...##........#.....................#.......#..
                                                  ...........#..#.............................#.................#..##...#.............................
                                                  ..................#.#...#..#....#....#..........#................#..#.........#......#.......#......
                                                  ...#...#....#.#................#.............#.............................#..#.....................
                                                  ....................#.........#..#.#...#.#.##...#...#..............#.......#.........#.............#
                                                  ...#.....#.............##.....#....#.#.......#......................................................
                                                  ..........#..#...#.......................#.................##.....#........#...#......#.......#.....
                                                  ........#......#...............#.#.....#...........................#.....................#.......#..
                                                  ..................................#...........#......#...........#.............#....###.............
                                                  ................#.......................#.#......#.##..........#......#............#................
                                                  .........................................#..........................................##...........#..
                                                  ...#.......#....##.#....#...............#..#...#.............#...#....#.....#.#...........#.........
                                                  #........#...........#...........#.....................#........#..................#.....#......#...
                                                  ........#.....##..#.........................#....#..........#.##..#.......#.#.................#...#.
                                                  ..........................#.............................#........#............#.............#....#..
                                                  .............................#..................................................#...................
                                                  ................#.............#..#..........##......#......#.........#...........##............##...
                                                  #...#.......#.............#............#..........
                                                  #................#...#....#..................#....
                                                  .................#.....#.#....#......#...#........
                                                  ..................................#...............
                                                  .....#...............................#............
                                                  ...............#............##..........#.......#.
                                                  #............#.....................###.#.........#
                                                  .#...............#...........#....#......#........
                                                  .#.............###.#................#........#....
                                                  ....##............#..........#.#.........#.#.#....
                                                  ..................#..#..............#......#......
                                                  ....#.............................#...............
                                                  .#.#..........#...........#......##...............
                                                  ..........#......#....#...#.#....#..#.............
                                                  ................#...............#.................
                                                  ..........#..#...#..............#...............#.
                                                  ...#..............##..............#...............
                                                  ..#...#.#....#.........#.........#.......#........
                                                  .................#..............#.........#.....#.
                                                  .......#........#......#............#......#......
                                                  ..........#..............#....#..#............#...
                                                  .......#............#.............#...............
                                                  .....#.#..........#.#..........#..................
                                                  #...#...................#......#......#.....#.....
                                                  ........#........##.#.......##................#...
                                                  ..................#.........................##....
                                                  ..#................#..............#.#....#.#.#...#
                                                  ........#..........................#..........#...
                                                  ..#.......#.#............#..........#.....#.......
                                                  ....#....#...............................#........
                                                  ..#............................................#..
                                                  ....#.......#..............##.......#......##.....
                                                  .#..........#......#....#.#........#..............
                                                  ................#.#.......##.............###.....#
                                                  ...............#......##.#...#................#...
                                                  ....#.......#....##...#..#..........#.........#...
                                                  .....#.........#...#...........#........#.........
                                                  .......#...............#..................#.......
                                                  ...........#.....#.........#........#....#.......#
                                                  ..#.....................................#...#.....
                                                  ..................#..............#....#.#.........
                                                  ........................#.......#.#......#........
                                                  ...#......#..#..........#..#..#........#..........
                                                  .....#.......#.........#.............#.......#....
                                                  ......#......#...............#.....#.........#....
                                                  .#.........................#.....#.............#..
                                                  ...#......#.#.....##...#.#....#.#...............#.
                                                  .............#........#.#.#.....#.................
                                                  ...#.........#.........#....#.................##..
                                                  .......#.......##...#....#..........#.#...........
..#......#....................#.........#........#.....................#............#.....#.........
.##...........##...................#.#..................................#...........................
....#............#..........#..........................#...#......................#....##...........
.#...........#........................#..............................#..#...................#......#
#................#.#........#...........................#....................#...........#..........
#.....................#.....#.......##....#......#..##...#...........#...................#..........
.........#..#......#....#......#....#.......#.....................................................##
..#...#......##.#..................#.......#.............#....#....#.........#..............#.....#.
...........#...#...#.#........#..................##...........#.....#...............................
.............................#....##..#..#..........#.............................#.................
...#.................#...#...#...#.................................................#..............##
......#........#........#.........##....#....#.....#.......#.............#...##.##.#................
..#.......................#....................#..#...#.................#......#..........#......#..
.........................#....#..##..............#.............#.#...#....#.......#...#....#.....#..
....#................#.#...........................#....#..#.......##.#.....#................#.#....
..#.......................#.....#...#..#..#...#...#.............................#............#......
#..............................................#.......................................##........#.#
..............#.#............##..........#.........................#..................#.#...........
.....#......................#...........#.....#.................#................#........#...#..#.#
......#.#....#......#.#..................#.#................#.#.#...........#............#.....#....
.#......#......##..............#.........#.#.#.#..................#...#..........#..................
...#...........#.............#....#.#...#....#.......................#.#.....#.....#..............#.
...#...#.#.........#...#............#....#.........#.....#......#..#...........#.....#......#.......
.#.....#..........#..............#..#........#..............#...#.............#.#.......#..#........
.....#........................#.....#......#...............##..#.#...#...#.#............#...........
.....#......#.........#....#.......##.......#.##..................#...............#......#........#.
.#..#..#..#.................................#......#.#............#..#....#...................#.....
.#..#...........................#....#............................................................#.
......#..............................#..#.......#.........##..........##...#........................
............#...............#..#..#..........#......................#...#.#............#............
...##..................#.....#.........#......#...........#.......#.....#.......................#...
..#..#..#......#......#.....#.......#.................##..#.........................................
............#...##...#..........#.................................##....#........##........#........
...##...#....#....#........................#.............##.........................##.......#......
.............##..................#...................##.......#........##.............#.#..........#
.......#.....#...##..............#..........................#..........#..........#..#.............#
............#...#........#........#...............#.....#.....#.......#..............#.....#......#.
...........#.....#..##.................#......#........#.#.....................#....................
.....#......#.........#..........#..#......................................................##.......
..........#.....#......#.#.........#.....#..................##.............................#........
##......#...#..........#...............#.............#........#..................#........#........#
..#.........#...........#.......#...........##...................#.................#.#.....#...#....
...#.........#..................................#.....#..#............#.............#.#.............
....#...........#..........#..............#..###........#..#.........#....................#.#.......
..#..........#..#...............................#...#.................#............#............#.#.
.....................#.............#....#..#....#......................#..#......#..................
........#.#.............#....#...#.#.....#..........#................#.......#........#....#.#.....#
##.........................##....#...............#..........#......................##...............
.........#..................................#........................#....#............#...#.#......
........#........................#..#...#..........................#................................
................#..#.......#..#...................
.............#........#...................#.......
..#....#.......................#..........#...#..#
..........#.....................#..............#.#
.........#...#...#..............#..#.........#....
...........#.....#................................
.......#..#..#.......#............#...............
.........................#..........#..#....#..#..
#...........#....#.....#....#.#..#.......#........
#.#.......#.....#........#....#...#...............
..............................................#...
#......#....................................#...#.
........##..#.....#.#......#.........#..##....#...
...............#.........#...#.......#......#..#..
..........#.#......#.....#........................
.....#.....#......................................
..#..#............#.......#.....#..#.......#...#..
...............##....#........#..#.............#.#
..............#..................#.....#......#...
#.......#.......#...#...............#.#....#......
#.........#........#..........#........#....#.....
.....###.#...........#...........##............#..
.........#..##.......#......................#.....
.....#.##......#.......#...#.............#........
##.................#.....#.............#....#...#.
........#..............#.#.........#.......#......
........#..#.#.....#.............#............#..#
.#.....#.#..#..#.##........#..........#.....##....
.....#....#.........#.............................
................#..#....#.....#....#........#..#..
#.#............#.....#.............#.........#....
...#....#..........#.#.................#.#..#...#.
........#................#...#......#......#...#.#
..#.............#....#.......#..............#.....
.....................................##.........#.
............#.#...................................
..#...........................#..........#........
...#.............#..............#..........#...#..
#......#...#...#...#...#..................#....#..
....#......#..#....#.#.#..........................
..#.......................#..............#..#.....
................#........#...#..........#.#.......
....#...#......#...................#.#.#...#....#.
............#..............#........#..#.....#....
..........#...............#.......#...............
#....................#.......#...........#........
.......#.........#..........#.#..#.#..............
..#.........##......................#...#.........
...#.................#.##............#........#...
....#......#..#.....................#.............

50L40L41L1R13L7R23L34L22R15L47L26R42L36R10L19L16L10R20L19L46L6R46L31R37L21L23R13R42R26L27L27L39R5L46L47L17L40R45R10L6R3L42L46R23L28L10L28R25R40L46R9R37L1L28L44R16R36L39R19R32L21L40L26R26L7L16R33R9L48R45R34R31L32L5R41R3L7R12R42L31R14R32L25L30L23R22R45L2R46R31R38R35R14L12L7L12L50L39L4R4L42R43R27R1L48R47R34R50L22L48L6R50R34R1L34R45R20L39R22R3R5R34R31R43L5L12L14L20L25L25R13R37L25L16R1L23L28L35L25L12R43L33L29R49R21R10L14R33R19L7L40L4L27L24L18L30R5L18L13L35R24R10R31R13R22L47R27L20R37L37R11L45R48R41R6R41L32R17L25L31R17L28R9R25R48R9L1R29R34L1L19L48L9R27R28L18R27R34R14L8R5L17R9L47L23R47R44L34R29L7R44R28L33L43R21L8R13R37R3L29R23R15R33L12R42R49L9R40R13R18R49R29R12L50R7L11L24L27R9R46R22R33L5R47R24R12R46L10L10L16L12L31R34R9R40L18R32L24R19L6L3L13L49R4L34L47R13R40R2R21L36L33R23R21L14R30R13R4L42R4R31L44L48R19L41R48L25L23L44R45L4R29L5R9R32L39R4R40L25R18R40R12R43L31L2R33R18R50R27R7L29R3L35R2R35L41L24R43L48L3R15L15R41L17L4R33R41R8R40R37R12L5L3L14R14L5R21R48R35R20R3L42R21L33L26L12R34R3L23R46L31L4R39R34R28L48R28L18R35L32L21R28R5R32L50R22R46L16L19R50L1L27R1R41R25R36R1L5L45L28R9L14L9L20R11L48R32L2R16L45R46L30L46L17R3L18R7L29R3L46L12L33R33R21L34L42R1L14L47R50R22R24L12R20R40R21R36L4R7R14R50L36R43R34L36R3R39L42L8R1R35R42R11L17R43R21L4R45L33R8L14R5L37L15L16R43L38R5L47R24L22L27L6L21R10L12R10L36L15R36L39L16L11R14L42R23L24R29L11L25L16L19L39R14R26R40R16R12L2L49R40R41R45L21L9R3R39R50R25R25L36L33R7R17L14L4L42R19L49R10L12L14L2R10R42L31R33L6L34L11L23L40L15R43R50R46L7L4R30L9R15L15L24L32R8R23L44R10L4R17L23L35L4L45L8R4L30R2R24L7L3R3L43L48R38R35R32L18R5L6R12R30R11R25L31L20R20L9L43L26L45R45R8L32R11L1L41L6L9R7R6L11R5R10R33R30L8L9R29L32L9R14L17L15L6L46R20L15L47R45L19R49L29L18L5L3R38R42L34L31R21L15L19R48L34R10R28R36R40R31R17R31L38R31R25L5R47R7L7R15R38L44R49L37R9R36L2L8R35L23L37R50R30L5R34L23L9R45L32L29L10L34L7L48R45L43L14R38R30R46R17R11L3L31L27R41R25R33L27L48R28L47R36R45L27L49R9L33L7R39R26L22L14L30L14L45R50R16R28R6R10L1L1R12R8R14R41R45R19L43R24L25R4R11R16L23R1L1L21L47L6R34R47R18L35L32R32L30L36R12R5L30R25R8L18L36R21L29R50R16R13L28L34L9L21R30L4L3L13L5L46L6R42R34R24R27L29L39L22L26L9R4R20R46L35R13L25R9L24L38L27R20R44L21L41L10R15R11R9R4R40R18L10L24R26L13R28L29L17R30R18R8R22R20L35L8L13R1L33L27R40R43R20L50R19L27R30L30R35R1R37L1L32R35L2R11R24R34R39R13L44L26R37R1L3R38L16L44R10L28L26L34L16R16L20L15L26L39L7L5L29L38L13R47L25R36R45R6R4R34R15R22R49R12L8L36L7R47R16R35L30R24L38R11R28L33R41L43R12R15L35L33R48R17R13R47R20R43L33R19L38L19R36R11R45L18L13L31L25L21L10R1L11R8L49R25L37R29R13L44L20R22R28R44R12L24L11L8R30R38R34L39L24R20R1L16L19R23R36R16R49L4L2R47L26L6R40R43L21R13R43R43R43R37R7L48L37L26R44R39R29L43L44L3L12R15L40R42R34R6L31L41L15L12R38L29L41R48R6L5L4R41L32L10L34L12R24L32R24L24R29L22R20R15R18R31R3L12R44R8L3R24R45R28L43L37L41L26R43L8R43R19L13R9L6R24R35L3R47R35R15L23L50L42R18R3R2R16R1L44L48L1L20L43R10R47R48R29L43L26R21L25L36R6R35R50R11L30R15L12R49R18R5R12L6R30R36R14R31L36L34L26R34L6L4R37R46R1L14R25R48R28R16R24R14L16L46R4L18L16L20R38L23R14L23L3R18L17R45R50L48R18L33R27L45R29L8L48L23R27L24L1L40R2R29R2R19L50L42L40L45L10R40L43L47R25R19L38R3R5L35R44L16L26R25R1L7L3L38R3R39R47L8R34L17R12L50L33R39L6R46L46R38L26R31R31L25R43L18R8R13L43L50L24L15R50R42R33L21R39R35L6R10R3L3L20L28L6R37R26L43L23L15R32L14L28L7R41L22L25R37R27R23L27R27L24R36R18L35R49R8L3R23L29L20R32L25R18R31L13L18L1L46L45L17L44R17L15R38R43R34R38R11R31L49R47R50R24R42L13R9R33L28L45L12R23R39L18R1L41L5R4R1L30R16L50L15R38R39R3R19R12R50L13L34L28R18L11R19L36R43L5L15R12R3L48L23L41R48R2L16L22L32L20R46L33L14L37L23L22L4L31L40L1R38L7R9R19R49L26L26L15R32R46L4R1R2L37R14R21R27L6L23R35L34R4R2L40R29L26L12R7L4L25R28R34L42R38R19L22L8L36L50R25L37R26L47L10R47L48L32R36R10L15R15L31L30R4L3L22R39L22R36R21L15L26L50L6L39R22L49L22R10R31L10R24L25R47L19L14R20L11R14R48L48L27R6R38L2L33L32L20L23L40R22L34R11L31L22R3R10L29L32L19R46L16L31L5L35L47R35L41L46R50R14R35R36L13R31R21L22L43L40L3L47L44R17L50R47R42R39R29L23L48R44R47R15L38L26R50L5L4L12L7L21L38L29R22L1L39R3L7L41L13R35R25R2L49R49R6R3R34R13L43R30L18L27R7R26L32L35L4R30R36R38R36L21R21L46L31L8R50L37L17R50L48R29L4R9R32R8R37L39R31L22L17R23L17L14L6R1L26L30L4L16L23R47L21L12L49L2L37L20L22R29R19R37L39L47R6L43L9L24R4R20R46L28R50R7L19R16R12L3R6R34R21L9R40R17R11R23R23L1R43L29L17R10R35R21R40L2R47R4L25R23L32L40L33L48R43L32L7R32R22L19L1L46L20L29L49L26R6R39R6L48L12R42L10R46R20L43R3L31L7L18R1L39L9R20L5L47R47L38L6L5L41R6R25L40R26R17R11L18L14R47L39L42R17R35R22R18L42L17R29R41R2L35R1L36L5L18R5R38L7R16L18L9R26L2L29L10R5L1L48R35L22R49L31R36L46L19L17L1L33R49L25L21L22L1R5R45R47L40R4R43L37R26L35L33R39R49L24L44R9L16R33L13L29L43L50R6R28R11R14R11R2R12R36R15R33R39R49L17R4L29L45L25R38R31L47R36R14L26R7R2R35L43R29L33L42L3L32R34L15R32R9L17R3L41L24L7R39L36R26R32L46R7L15R20L50R45L26L13R38L48L7L5R37R6L49R41L31L35R8L1R30R1R9R8R29L33L23L20L6L6L50R26R1R30R19L44R45L36R16R20R42L25R40R43R13R34R24R34R3R39L30L46R27R7L33R32L2R16R48R27L50L50L27R25R35R8R19L2R50R3R37R19L8L34R26L38L48R35R37R45R31R32L22L36L11L27L19R39R41L26R20R21L37L41R50L47R44R39R38L18R21L5R50R25R34R4R21L27R18R32R14R5R6L39L35L48L24R25R47L40R31L49L2L5R45R15R46L17R47R50L27L22L33L8R38R27R13L16L8L2R11R13L36R10R34R42R22L16R40L48R27L30R9L21L49L35R42R26L40L33L11L6L36L2L39L44L49L10L28L8R3R14L7R40R5R50R19R43L20L33R29L42R41L23L18R1L20R38R20L15R31L13R19L27R11L14R28L29R44L2R5L50L27R43L21R27R25L4R36L38R46L29R22R29L12L46L10R43L2L26L45R39R30R39L12L21R43R16L11L2L19L19R32L28R31R21L13L22R2R47R30R9R4R46L2R48L17L50L25R41R45R40L23R11L12R19R43L29L32L48L3L13R34R39R35L44R40L30R3R7L45R17R26L20R10L37L47R3L30L29R25R30R16L41R21L11L27R15R37L30R15R39L34L38R48L21L23R22R11L4R4R12L41L45R45L32L23R22L41L32R15R7L45L3R4R26L9L50R28L27L20R12R9R19R10L47L33R1L44L32R2L44L15L36R31L50R41L29L40L11L46L31R37L34R47L41L2R48R5L49R10L43L9R2L9"""

input_data3 = """                                                  .............#.................................#...#.......................##..............#.....#..
                                                  .#..#......#..............#...............#..#....#..#.............#................................
                                                  ..........#...#......#...........................................#.......#.#............#...........
                                                  .............#............#...#.#..........#..#...#..........#.........#......#............#......#.
                                                  ....................#................#.............................................#................
                                                  ....#.##..#....................#...............#..........#...............#........#.............##.
                                                  ...#..#.........................................................#...............#...................
                                                  ........................................#...........................#.............#.................
                                                  ...#.............##..................#......#.....##..#.#................#............#.............
                                                  #..............#.........................................###..............#......#.........#....#...
                                                  .....##...#..#..#....#.....#................#.#......#......##........#......#..#.......#...........
                                                  .......#........#.............#............#....#....#............................##................
                                                  ..........#...........#........................#.................#..#.#..#.....#.......##..........#
                                                  .#...#.....................#...........................##....#.................#....................
                                                  .#.....#.#..##............................#..............#.............#............#...............
                                                  .........#.#.................#..................#.......#......#.....................#..............
                                                  ....#.##.....................#.......................#.................#.............#...#.........#
                                                  ........#...........#......#..............#........#.#..#.....................................#....#
                                                  ..#................#....#.....#......#...........#...................##..#.................#........
                                                  ..........#.....#................#.#.#...................#...#.........................#.......#.#..
                                                  .....#..................#........#..#................#......................#.....#.#...............
                                                  ..........................#..............................#..........................................
                                                  ........#..............#..#....#.##........##..#.....#........................#.......#.............
                                                  .................#....#.........#..........#.##.#...............#..............#.#.......#...#......
                                                  .....#..............#............................#......#..................#..............#.........
                                                  ..............#...#.#...#........#....................#.....##..#......#........................#...
                                                  ..................#...........#.............#........#.#.....................#.....#....##..........
                                                  ...........##..........#..................................#.............##.#.................#......
                                                  ...#......................#.....#.............#........###..#..................#........#...........
                                                  .#...........#............#........#................................#...........#.........#......#.#
                                                  ..#....................#.##.##.#...#..........#..#......#............#................#.........##..
                                                  ...##.#.....#......##.......#.#....#......................#......#...#..#............#...........#..
                                                  ...............#...#.............##........#.........#..........#...................................
                                                  #................###.....#......#.............#...#...........#.#...................................
                                                  ..........#..........#....#.#.............#....#..........#......................#......#.....#.....
                                                  ...#..#..........................#.#...#..............................................##............
                                                  ..#..................#............##............#.....#...#.....#..........#....#........#.........#
                                                  ......#...............#.....#............................#.....#........................#.........#.
                                                  #..#........#.................#......................#..#.................#.#....#.....#.#..#....##.
                                                  .#..#...............#.................#.#...#........#.........#................................#...
                                                  #......#.#..........................................................................................
                                                  ..........#.....#.....#...........................#..#.......#...##......#......#.#.......##........
                                                  ....................##.......###.........#...#...........#.................#......#...#.....#.......
                                                  ..............#........#.......#...................#..........................#..........#....#..#..
                                                  .........##...#........#.###...#...........#...............#..................#......#.#.#.#.#......
                                                  ....#.....................................................................#.........................
                                                  ....................#..........#..#...#..#............#..........#....##....#...#...................
                                                  .........#.........#......................#....##...........#.......#................#....#..#......
                                                  ..........#...................#.......#.##..........#..........#....................................
                                                  #...........#....#.......#............#.......#...#..#.....#..........#.#..................#........
                                                  .#..............#..#...#....#.......##....#.......
                                                  .#..#......................#..................#.##
                                                  ..#.......................................#.#.....
                                                  .#..........#........................#............
                                                  .#........#.................................#.....
                                                  #......#..#........#..#...........................
                                                  .......#.....#......#..........#..#..............#
                                                  ........#....#................#........##....#....
                                                  .............#......#.............#.........#.....
                                                  .................................#......#.........
                                                  ....#.........#.....#.........#.#.................
                                                  .......#.###.....##.#.#..........................#
                                                  ............#..........#.........#......##..#..#..
                                                  ...............................#......#.#.........
                                                  ....#........#..#...#.................#...........
                                                  #...##...#.........#..............##...#..........
                                                  .......#..#.............#....#..#..#.....#.....#..
                                                  #............................#....#..#.....#......
                                                  ............##...........#......#.................
                                                  ........#..............#........#.................
                                                  ...........#..........#............#.#..#........#
                                                  .................#..#.............................
                                                  ..........#.........................#....#........
                                                  ......#........................#............#.....
                                                  .......#...#.............#.#........###...........
                                                  ................#.#.....#.#......#.....#..#.#.....
                                                  ........#.............#......#.............#...#..
                                                  ...#.#....#.............##.#...........#.......#..
                                                  .##..........#.......#...#...#...###..........#...
                                                  ...#......#.........#....#.....##.................
                                                  ..........#......#........#..#.#.......#..........
                                                  .................#........#.....#.................
                                                  ...#..........##......#..........#..#...#......#..
                                                  .............#....#..#.#......#...............##..
                                                  ....#...#......#....#....#.#..#...................
                                                  ...#.............#...................#............
                                                  .....#................##..#....#.......#.......#.#
                                                  ........#.........#....#........#.................
                                                  ..................#..........................#....
                                                  .....................................#............
                                                  ..........#.....#..........................#.....#
                                                  ..#.........##...#...#..#.........................
                                                  .............#.......#................#...........
                                                  ..........#..................................#.#..
                                                  ...#........#....................#.#.....#........
                                                  ..................#...........#..............#....
                                                  ....#......#......#...#...#...#...................
                                                  ......................................#...#.......
                                                  .....#.....#...........#......#...................
                                                  ..........#...................#..............#..##
.....#..#............##.......##...#................#........................#.........#...#........
........................................#..............................##...............#...........
.....##.#..........#.#..........#...#........#..................##...#................#.............
.......................................##......#......#......#....................#............#....
................#.......#........##.......#............#..........................#.............#...
.................................#.#.....#............#....................#.#....#..#....##.##..#..
.................#..#.......#.....#................#......................#.............#.......##..
........#.........#..........................#....#.#..#.......#...#................#......#..#.....
............#.#.....#............##.#...............#...........................#........#..........
.............................#..##..............#................................##..#..............
.................#.#...#..........#.....#...........................................................
..............#.....#.................#..#....#.............##.........#...................#......#.
.#.#...........#......................#..................#...........#....#..#....#...#......#......
.#.#........................#......#....#......#...........................#..#.#..#.........#......
.....#............#...#...........#..............................#..........#.....................#.
....#.##.....#.....................#........#.................#........#.....##..#.........#..#...##
..................#...##..........................................#.#...............................
.....#....#.......................#.#.........................#..###..........#.......#.......##....
##.........#................###...#..#......#.....#.................................................
.........#..........###....#.....#..#...#.#..................#.............#..#......##..#.......#..
.#.......#............#.........#.............#...#..........#.......#..#...............#...........
...#....#......#....#..........#.#..#.#.#............#..........#..............#......#.............
...........#....#.....#.#......................#..#.........#.........#....#........................
...............##....#...............#..........#..#..#....................#.##..................#.#
........##..#..................#..........#.............#.................#..#.................#....
.#....................#...................................#..#....##..#.#..............#............
...#..#.....#...#....#.........................#.....................#.#..#........#..........#.....
........##....#....#..............................#......#...........#................#.............
................#....................#................#.#...........#...........#..#.....#..#.....#.
...#..#.#.........#.#...#............#..#...............#..............................#........#...
.##.......##...............#.......#.......#...#.......#.#....#.....................#.#......#.##...
.....#........#.#.............##......#.........................................................#...
##...........................................#.......#..#........##..................#..............
..#.#...............#..................#..........#........#...........................#............
..............#....#.#...........#...........#.......#.............#........#..#.#.................#
.......................#..........#.......#............................#............#.......#.#....#
#........................#...##..#.................#.#......................#......#.#.........#....
............#......#.##........#.....#........#.............#...........#...#......#..........#.....
.......#..#....#........#..............#.......#.#.....#..#................#..#.....#...............
....#.................#.....................#......#........##......#...............................
.............#.......#.#.........##.#..............##................#......#................#..#.#.
.....#.......................#...................................................#...............#..
#.......#...............#.......#.........................#...........#.#...#.......##..............
#.......................#..#........#............##............#..#..##..........#......#.#.....#...
.#....#....#.##.#......##.#..#.#.##..#.#..............#........................#...#................
....#...#......#.#.............................##..........#......#...#..#............#.............
.....................#..#.#.......#............................#.#.............#...#...#...#.....#..
...............................###..........................#.......#..#...............##...........
..............#..#......#....................#................#...#...........##.............#......
......#.......#...#.....#..#..................#...#...#.........#.....#.............#.........#..#..
...#.......................#..#.....##............
......................#..#....#..#................
....#............#....#....#.#....................
..............#............#..................#...
....#.#.......#..................................#
..#.....#..........#.........#..................#.
............#...............#...........#.........
...#......#..........#..#..##.............#.......
....#.....#................#......#....##.........
....#.#.........#...............................#.
...........................#........#.............
...#.................................#............
...........................##..#..................
.....#...#......#.........#............#........#.
............#.......................#..........#..
#.#.........#.................#.....##.#.......#..
#...........#....#.....#.......#...#..............
.......#...#....#........................#.#......
.#......................#....#...#...#............
..........#..........#..#..........#..........#.#.
............................#..............#..#...
.......#.......#..................................
...#.........................#.........#........##
.#...#......#....#..#.....#....##............#....
..#....#.....#............##........#.........#...
............#............#....................##..
................#.........#.................#.....
......................#..#..#.......#.............
....##..#...................#..................#..
.............#.......#..........#.........#......#
....#...#......#....#..#......#...................
............#..............#...........#..........
.#............#..............#....................
.....###........................#.................
...............#..................................
....#.......#.....................................
.................#..............#......#..........
.........#...........#.....#.....#.......#.#..##..
....#.#............#....#..#.......#........#..#..
..#...#.................#........#.##.......#.....
..............#..................##...#...........
.......#..................#.#..........#..........
...........................#.....................#
......#.................#.........................
....#.....................#.....#......#......#...
..................#.#.....#....#.............#....
..........#..................#.#..................
......#....#....................#................#
#.#..................#............................
.............................................#....

24R38L36R1R28L11R39L5R36R41L31R9L16R4R36L38R31L38R17L18R31R6L40L2L19R41R27R24L33R21L27R7R11R27R11R2L46L34R3L23R29L45L13L25L37R46L21L20L22L4R31R36R10R13R39R27L27R20L12R49R21R44R50L5L9R13L11R26R44L48R44L24R44R46L49R20R13R27R4L25L5L39R10L29L12R3R39L11R49L13R45L2R3L50L12L33R22L20L2R37L32R32L1L41L26R1R10R25R49L48L24R48L27R43L28R7L30L15R46R32L11R7L2R24R32R16R16R10R28R11R19R5L45R4L20R49R24R44L31L46L29L32R2L48L33R36R44L41R37L17L35R40R14R48L45L16R42R30L22R28L17L2R24R22L37R3R6R32L4R1R42L33R44L9R22R19L16L17R17R37L45R46R1R34R45L10R22R12R28L42R31L27L33R24R29R24L40L41L26R9R23R11R20R13R28R20R16L17L14R48L34L12R16L12L30R42R15R19R20R15L39L8R33L31R35L12R29L37R42R4L41L30R15L12L6R27L10R23R17L10L23R35L48R47L46L12L27L22L46R50L37R45L37R21L8L2L18R46L3R23R18R32R37L27R43L39L23L40L27L22L22R30L30R35R38L40L50R8R9L20R29L27R9R2R16R32L4R49L44L13R17L47L29R46R22L27L7L37L17L7R2R3R24L47R50L17L17R31L23R19L6L42L42L43L5R42R36R47R13L7L42R22L2L5R31R49R43R35L19L29R11R3R29R34L41R45L28L39L14R31L4R23L35R40R32R39L36L6R13R37R23R21L14R37L35R12R50L35L5R25L45L8L8R14L24R25L29L20R3L36L16R22R2R19L23L8L3R43L22R27L31L48R21R2R7L27R36L5L15L5R8R41L46R28L26R45R42R9L38R35R38R22R18R13L40L11L5L44L27L28L23L37R8L40L13R35R48R18R29R7L9L10L45L12L45R21L28L36R49R18R40L41L8R2L40R9R10R42L23R19R12L27L33R42L30L25R12R5R36L14L14L4L24L39R14R37L1R16L28L44L12L45R21R7R5R1L7R48L38R1L49R15L26L12R36L7R46L24L28R39R7R33L49R34R37L34R40R18R44R26R48L31L50R48R33R15L48L2R36L46L12R38R10R20R48R38R25L9L23R39R28R50L47L47L49L39L46L8R15L19R27L48R48L25R46R27R1R15R15R46R41L50R25R38R33L41L18L43L35L43R18L29R8R7R35L43L46R32L17R31R39R30L32L20L10L34R25R11R10L49R31R45R1L18R30L15L48L21R8R22L35L49L7L6R23L4R31R42L7L20R41L24L40L46R2L45L40L26R41R10R34L25L20R10L34R44R2L16L8R30L2R47R31R47L32L41R33R3R39L30L24L47R12R23L40L9L22L28R30R24L25L22R47L18L21R41L40L9R23R32L16R6R36L17R45L38L10L30L11L31R28R6R8R43L8L45L45L10R21R26R32L9R6L13R29L25R16R24L5R34R18L28L16L21R8R9L33L13L47R29L17L45L12R38R46L43R42R26L41R5R34R1R48R38L29L2R48L32R16R48R14L8L13L32R4L49R46L45L40L30R23R44L24L6L3L29R29R7R19L14R10L44L22L4R27R27R46L8R46R46R18L32L30L14R50R42L38L3R32R20L50R44R40R39R18R18R12L8L31R17L10R31L45R14L15R49L31R37L20R17L43L43R18R10R38L30R13L35L22L30R3L46R7R14L23L1R6L27R25R17L7L23L39L45R45L40R7L21L7R36R32R4R49L20R38R35R44R35R26R50R46L24R2L6L46L9L43L27L34L38R36L23L6R12L28L50L8L50R20R31R24L14R13R21R43R17L17L42L43L29R1L26R43L46L47R20L36R34R49R11R21L33L42L35R37L32R8L17L43L10L27R41L29R12R28L44L9R47R12L25L43L18L7R4L5L9L13L25L37R14R11L3R6L17L1L41R10L33L44R50R43R6R38R48R2L15L31R40L40L42L14R23L14R9R47L44R12R26L21L17L20R46L30L29R3L14L6L47L27L18L16L9L23R4L1R34R35R10R23R37L2L8L25L26L34R17L5L3R25R20L50L4L46L10R5L17R23R30R15L39R44L8L19R43R19L15R14L25R19R50R33R15R9L46L47R34L5R38R42L22R43L46R47R24R11L40R14R47R5L28L1R1L45L20L25R40L44L21L49L17R45L34L3L2R13L30L37R35L36L33R18R34R14L25R14L25L3R13R12R50R16L20R8R49L23L4L3R29L16L19R34L8R15L5L38R38L8R7L18R44L29R19R21R25R23L42R49R6R19R48R37R32L2L14R22L24R28R50R5R10L45L24L12L48R16R47L26R1L38L48L12R6L35L31L3R13L26R7L1R19L47R15R29R2L16L24L7L49R26L44R12L30L25L32R43R48R12R9R4L43L32L22R22L6L18R44R42R39R11L26R37R42R12L11R10R14R44R4L47L3R25R4R50L36R3L4R36R5R38L35R4R37L35R23R43L47L33L1L2R19R14L33R26L1R27R45L32L29R5L28R10R50L1R14L4L31R47R2R27R39R18R50R50L45L15L17R21R40L19L15R14L9R44L45R28L17L19L41R35R27L6R43R16L34R4R28R12R45L33L44R40R36R36L23L25R35R24R1R30R1R50L23L18R36L33R15R2L10L5R41R10R39L15L33R19L37R12R33L6L20R48R24R38R13L29L32L41L27R27R15L18L22L1L7L18L33L33L4R22R12L35R38R40L43L40R45R7R50R4L29R26R7R42L34R2R39L28L41R33L35L40L31L4L40L25L30R44L45L40R22R13R50R4R5R36L21L29R24R10L6L45R15L40L26L10L10R18L22L29L46L6R33R31L44L42L28R49R29R39R45L18L20L34L38L16L1R50L21R25L15R16R22R33R43R34L32L23R33L26R6R16R31R1R30L35L28R4R1R19R25R40R8L46R1R45L28L16R25R44L44R37R26R11R7L7L33L2L8L31R46L31R33L45R31L19L4L30R8L16R20R24L43R41L6L20L43R15L30R35R45L18L35R23R5R25L35R21R48L13R3L18R34L27L13R47R18R10L4R28R37R8R28L16R43L4L8R19L34R9R40L47L32L10L38L34L25R34L27L26L34L32L45R29L12L36R14L42L39L25R15L23R45L36R32L7L22L42L46R40L17R30L33L33R12L48R19R24R36L38R41R22L24R4R15R7L30R2R5L11R22L25R25R9R45R4R10L22L15L6L41L33R5R21R16R21R21L23R40R21L29R43R35L9L50R1L25L40L41L12R22L33L47L15R21R3R47R2R16L8L20R43L48L13L46L38L45R20R37L21R7L5L8R4L35L17R23R34R19L22R25L9L37R39R21R22L30L38R48R17L18L21L31R9L3R20L14R25L4L33L10R16L26L10R31R37R17R36L18R27R31R24L36L38R46R23R24L5R39R11L19L39L25R10R32R2R43L7L5L12R50L25R13R27R19R26L12L40R3R13R30L48R7L37L1R41L14L13L14L13R14R48R16L41R48L24R6R50R29R24L44R19L12R50R5L40R7R22R27L24L18R14R37L9R36R12L36R20L41R14R43R12L41L34R45R23L5L27L9L14L43L29L8R23R13L50L2R36R1L31L48L12R9R45L26R28L1L29L29L8R29L7L39L24R23L46L1L9L6L22R46L10L32L50L16R38R46L9R15R40R12R41R25L47R29L34L37L49L35R12L25L12L22R9L46L27R43L11L3R15L33L49R24L33L34R21R20R11L16L22L50L26L15L6L39R12R30R30L7R29L45R23R34R7L2R50R33L21L39R15R8R24R50R34R7R50R44L17L16R24R47L26L17R35R32R15L13L13R25R12L42R33L42R6R47L50R1L8R8R48L41R33L27R29R8R3R35L3L14L15L19L13L46R42L5L11R25R25R41L30L1R14R40R47R41L48R13R4L21R16L50R37L20R15R6R33L27L13R11L27R50R7R46R3R35R38L19R41L5R6L22L18L8R2L33R1R20R5R27L23L23R14R1R50L3L41R22L14R35R43R46R30R32L34R14R43R39R39L26R16L42R50L12L36R50R28L35L1L40L35R41L6L26L34L21R49R42R35R40L4L15R46R13L30R35R22L48R17L43R13R21L49L8R42R38L23R44R38R12R31L28R50R25R2R12L32R7R17R8R36L31L28L22R12L25R14R27L44R7R11L11L17L48R6L8L40L22L1R39L39L5R8L29L22L44R41R5L38L21R2R34L44L1R6R9L3L11L1R16L30L14L44R10L48L35L2R45L23L19L31R1L41R19R10R7R12R6L15R2R22L34L14L33R19R43R16R12R36R18R22L17R3R7R9R7R15L48L8L35R46R20L30L2L48L29L8L23L2L7R33L27L15L31R39R19L44L34R28L9R43L13L12L33L18L49R29R18R20R46L20R37R15R9R13R37L20L41L14R17R46L4R26L34L1L29L17R46R4R11R35R26L31L10L14R39R17R46L29R30R50R9R43R48R14R46L33R34R44L21R42R3L28L40R29L36R11R5L26R4R21R3L14"""

input_data4 = """                                                  .......#..............................................#.#..#.#..#.....#.........#.....#.............
                                                  ......................#..........................#.#.....................##.........................
                                                  ......#...#.#...........#...#..........#...........#.........................#..........#..#........
                                                  ..........#.....#.....##..#..#..............#....#..........................##.#..#......#.....##...
                                                  .......#....#...#.......#..#......#...#..........#...........................####...................
                                                  ...#.....#....#............#..#.#.....#.#................#..#........#.........#....................
                                                  ..............#...#....#....................#.#....#.##....#...#.#.#...#..........#....#............
                                                  ...........#........#.#......#.#..............................#.............#.............#....#....
                                                  ............#.........##..........##.#....##........#.......#.#.......................#...#...#.....
                                                  ...................#......#........#......#.......#....#...............................#...#......#.
                                                  ....#........................................#..#................##...........#.........#...##......
                                                  ..........................#...................#.......#.......##...#.......#...#........#...........
                                                  ........#....#...##...#.......#.....##...#..............#.................#..#.........#........#...
                                                  ..................#..........#...#...#..#...........................##...##.....#...................
                                                  ...#......#....#......#.............#.....#...........#...........................................#.
                                                  ...................#..........#..#.......#........#........#.#.....#...#............................
                                                  ..#.....................#..#....#.......#......#.................................#..............#...
                                                  ............#...........#..#..........#...........##...................#..#.............#.....#.#...
                                                  ..............##.........#.#........#.............#...#..........#.........................#.#....#.
                                                  .#............##................................#.......#......#...##...#.............#.............
                                                  ...............#............#...........#.#.............#..........................##...#...........
                                                  ...#.#...........#.......#..#............#.....#.......#....#.....#...#.........#.#.....#..........#
                                                  .#.....................#..#...........#............#........#........#....#.#.......................
                                                  ..#.......................................#...........#....#......................#..............#..
                                                  ..#..........#..#...........#..........................#..........#.........#....#......#..........#
                                                  .....#........................#......................#.#..#........#................................
                                                  #...#..................#....#..............................#......#.....................#.#.........
                                                  ...........#.............#...##..........#.......................#..#....#...#.....#..#.........#..#
                                                  .#..#..#.............##..#..............##.....#.............#......##..#.##...............#........
                                                  ........#...#...............#....#.#..........#..#........#..#..#......#.....#......................
                                                  ......................#...............#...............#............#....#....#.#....................
                                                  .#.....#.............#................................#.............................#.....#...#....#
                                                  .........#.##........#.#..#.....##.........................##..........................#............
                                                  ....#.........................#........#...........#..#....................#......#..#..........#...
                                                  ..........#...#.##...........................................................##......#..............
                                                  ...#..........#....#....#..#.....#....#...#..#....#..............#..........................#.#.....
                                                  .#.......#.#.....................#...........#..................................#.....#.......#....#
                                                  .........##.........................#...#......#....#............................#....#.............
                                                  ..................#........#.....#...............#........#.....#...................#...#........#..
                                                  ...............#........#...........#....#................#..........##......#.#....................
                                                  ....#.............#............#.........#...........................................#......#...#..#
                                                  ...............##...#.##.#.............#...#.......#..#..#...#..#...........#.....##.##...#........#
                                                  #........#...##................................##..#....................#.#.......................#.
                                                  ....#.#.......#..........#.............#.#............#........#.....##.#........#..................
                                                  ......#................##.....#.............#..#.....#.#..........#...##....#....................#..
                                                  ...###...............................#..................#.#..........#...........................#..
                                                  ...#.........#......#.#....#...........#.....#.......................#.#...#......#................#
                                                  .....#..#.#..#............#.....#........................#....#.................#..........#.....#..
                                                  ...#...........#.....#...........#.#..#....#.#...##.#......#.#.....#....#........#..................
                                                  ..#......#.#...##............#............................#.....#...........#.....................#.
                                                  ..#..............#........................##.#....
                                                  ....#............#...#....#..#....#.........#.....
                                                  ...#........#.#.#................#...............#
                                                  .#..#.........................#....#.#.....#......
                                                  ....#..........#....................#.#.##........
                                                  ....#.......#..#........................#.........
                                                  ..............#......#.........#...........#......
                                                  #......#.#............#....................#...#..
                                                  #..........#.....#................................
                                                  ..#.......##...#............................#.....
                                                  ..##........#..........#...##.........#..........#
                                                  ................#....#........#.....#.............
                                                  ....#..#.............#.............#..............
                                                  ..#.........#.......#...##.....#.......#...#......
                                                  ..........#.................#......#...#..........
                                                  ..........................#.......................
                                                  ...#...#.........#.....#.......#............#.....
                                                  ............................#..........##........#
                                                  ....#...................#.......................#.
                                                  ...#.....#.....#........................#.........
                                                  ...................................#......#.#.....
                                                  .......##.#...........###........................#
                                                  ...#.............#.#..........#............#......
                                                  ................#..#.....#.............#..........
                                                  .#......##.#......#.#..#.......................#..
                                                  .#...........#............#....#..................
                                                  ......#...#.#............#...#...#...#............
                                                  ...........##.......##.......#....................
                                                  #..........#......#..................#............
                                                  ......#..................#..........#............#
                                                  ......................#........#..........#.......
                                                  .......#......#.................#.................
                                                  ...................#.#.........#..........#.......
                                                  .......#.#..........................#..#..........
                                                  .......#..........#...............................
                                                  ..................#.........#................##..#
                                                  ##..........#.......#.........#...#......#........
                                                  ..................#.........#.....................
                                                  .....#......#................#....................
                                                  ...............................#..#......#........
                                                  ..........................#....#..................
                                                  .....#..#..#..........#......#....................
                                                  ........##...#..#......#..#...............#.......
                                                  ##.......#..........#...#..........##......#......
                                                  #.............#...............................#...
                                                  .#.............#..................................
                                                  ..................................................
                                                  .#...#...#..#.............#.....#......#..........
                                                  .#..#.....#..............#.##....#................
                                                  ...................#.#.........#..................
..#..##......##.#........#.#....#.......#................#..........................................
.....#.......#.......#........#.#.....#.............#..............#..............#.................
..........#....#...#...........................##...............................##.#...............#
..........#.............#.................##..............#.................................#.......
.#..#.............................................#...##..#.....#.......#.#..##...#.................
##.##...................................#...................................#.............#.........
....#.........#.........#............#..#.........#...........#..............#..........#......#....
.....................#...#........................#...........#.....#...............................
...#......#.....#....#.....#..........#.........................##.#........#.......................
.#.......#.......................##...................#.#..#...#.......................##...........
.#...........#.............#...#......................#..#...........#.....#........#......#........
....................#....##...#...............##.#....#.....................#.#...............#.....
.......#..#..#.....#...........#......#...........................#..............#...#......#.......
.....#.......#...................##..............................#...............#................#.
...#...........#...........##.#.......#....##..............#.##...............#.......#...#.#......#
...............#.........#....##........#....##.......#...................##.................#...#..
...........#.............#.........#..#.#..........#...#.....#............#.........................
...................#......#.................#....................#...#...#...............#..#.......
....#.........................................##...#..#.....................#....#..................
.................#...#.....#........................#........#.......#........#.....................
.............#........................#.#.....................#..........#..............#....#.#....
..#........#.#...............#..#.....#...#...............#..#........................#.#....#......
#......#........#....#.....#.#..........##.....#.....#..........................##..#.#.#........#.#
.......#.....#..#...........#..#.#....#.......#...........#...........#..................#..........
..............#............................................................#...#.....##......#......
..#....................................#..........#.#....##.....#...#...........#.....#.............
..................#...#.....................#.#.#..#..............#..#.....#...........#.....#...#..
.#.#..#.....##...........#.................#.........#.......................#.#...#.#.....#........
.....#...........................#.............#.....#.............#.....................#.......#..
....#..#...#............#.............#..#..#......#...#.................#....#....###..............
.........#.....#....#........#........#....##...#.......#...#.....#........#............#...........
##.....#...#.##................##........#......#........................#..#.....#.........#.......
........................#...........#.............................#.....#..#.................#......
.............#..#.....#..................#............#.........................#...................
............#..............#.#..#.....................#........................#..#.......#......#..
.............##........#.#......#....#.....................##.................#..#..##...........#..
......................#..................#.......................#....#.................#...........
#.....#.......#............#......#..#...#....#.#.............#.................#.....#.............
...#.......#.........................#...........##..........#..................#..#.......#.....#..
..#.#.#..............#....#..#..........................................#.#..........#.....#........
.....#..................#.#............#........................................#....#..............
.#.....#........#................................#..#...................##.#......#.................
##............#......#.#...##.............................#.......#........#........................
...............#..#......#.......#....#....................................#......#...........#....#
...........#..........#......#...#....#.....#....#..............#............#.............#........
...............#...........#....#.......................#...#...............................#.......
........#........#......#...#.................#..#..................#..................#............
...#.........#................#.....................#..##...................#....##............#.#..
...........#....#.#.....##......................#..#......#.........#...#...........................
.....###.........#................#............#...#.............................#.....#..#.......#.
.......#.......#.........#....#....##.............
.............#..##.#.......#.....#...#.........#.#
.#................#..#........#...............#..#
.....#.......#...........#.....#.....#......#.....
.#.#......#..#..........#.....#...#.#.............
.......##....#............#..#..............#.....
.#.........#..........#.......#........#..........
...#.....#.#.#..........##...................#....
.#..#..#..#...#.#....#.......#.................#..
........#......#......#..#..#.....#.....#..#......
..................................................
..................................................
.#..#.............#.........#....#..###...........
#.#....#......................#.#....#...........#
..................#..................#....#.......
...........#.........#....#..#...#................
#...........#..........#............#....#.#......
.#....##.....#......#.............................
....#.....#........#......#..#................#.#.
...#............#....#.#........................#.
..#..................#............................
....#.....#.................#......##.............
......................#...........................
#......#.#........#...........#.....#.............
...#................#............#..#..#......#..#
..............##................#.#......##.......
.................#....#.#.#..#.......#........#...
.......#........#......##...........#......#......
.#...............#....#...........#.#.............
....#..............##.#.....#....#.#...........#..
.......................##.....#...#..............#
..#..............................#.....#.......#..
...#......##..#...#........#..#...................
#.................................................
........#.................#...#.........##........
#..............................#..#...............
........#..#...#.....##.#........#....#..........#
#...#......#...............#..................#...
....................#.....#...................#...
.......#.......####...............................
.##...........#......#.........##.................
.#..#.............#.#...................#..##.....
........#...#...#........#.....##.................
.....#....................#.......................
......................#...........................
..........#.....#........##....#....#.............
........#............#................#...........
..#....................................#........#.
..............##.#......#...............##.#.#....
....#...#.#.#.................##.............#....

42L16R50R47L35L8L9L30L12R41L5R42L31R30L36R37L8R16R12L43L27R15R18L18L38R39R2L22R17L34R12L32L50R37L9R22L36R4L35R29L26R15L34L4L32R1R12L30R38R30L40L20L47L46R29L21R48L23L34R41L18R36R47R16L31R8L20L24L29R26L2R23L46L48L33R46R47L15R39L38L15L3R36L39L40L5L30R27R42L12L3R42L1R28R42L50R8R15R39L29L38R10L37R49L25L45R3L44R29L16R30L48L29L22L42R44L36R12R38R44R29L18L37R39L47L4L49L18R32R34L45L15R11R28L21R35L20L40L8L2R16L21L30R9R21L44L33R40L50R15L38R49L40L13L3L5L16L23L26L27L12R41L40R33L15L28L43R16R4R9R7L16R48R4R46L5R29R7R35R17L30L32R37L19L49R45R4L43R28R1L23L33L11R31R30R30R47R25R9R16L43L40L8L9L12R47R32R33R36L8L2L26R29R5R32R11R45R14L31R30L10L16R27R26R10R2R50R37L9L12L13R38R27R21L30L21R37R5L44L1L33R43R5R31R30R11L38L9L35L21R37R7R50L26R18L32R21R45R22R29L40R36L27R15R27R38R27R12R14R23L6L33L4R4L38R17L38R44L33L38L43R14L11L47L18R2R40R26L30R10L5L28L14L23L46L29L1L35L24R33L14R33R29L37R6L49L33R6L37R4L7L33L29R12L28R24L1R20R36L8L34L17L20R41R1R34R3L38R20R35R21L7R34L44L9R39L30R22L36L45L4R49R39R21L22L29R5L5L40L17L40R40R5L45R37R42R42R15L38L17L4R30R5R16R42R12L22R24R12L45R49R49L37R10R16L27L9R19R13R42R46L9L37R47L11L23R19R25L29R28L36L13R24R25L20R12L44L11L42R47L8L20L35R10L49R22L33L25R46L29L19R40R15L24L33R29R48L39R30L25L8L26L26L10L12R50L10L32R6R19R15L48L40L40L33R19L20L9R44R15R22R18L19R26R7L43L38L39L37R11L13R34R36R6R42R8R32R36R17R28R48L20L50R38R43L18L31L49R15L41R31L6R38L33L4L38R49R6L11L16L31L19R18R1R4R16R46L13R23L46L45L11L40L18L21L38L33R22R16L47L10L48R32R16R5L2R21R22R33R32L18L41L40R46R2L29R24L24R14R42L44L24R32R5R16R5L29R40R32L30L19L47R39L48R35R26L47R40L9R47R43R50L1R47R10L43R39L37L24L7R33L38R37R10R39L13L3R4R29R25R10R43R35L40L41R36R31L11L18R14R41R23R32L40R14L45L22L42L38R43R11L43L16R48L1L6R2R2L5L18R21L42R38L10R48L4R32R38L33R16R33L23L29L43R19R41R15L11L1L43R33R49L43R22R20L18L30R18L43R41R6L40L50R6R48R16L27L4L32R27R4R10R13R41L47R30R44L19L28R38R35R5L26R46R10R19L38R40R9R50R43R7R36L29L20R5L16L37L24L46L6L49L2L40L39L18L9R46L42R48L8L47R10R9R48L26R40L23L42L25R30R17R33R4R40R46R23L15R2L47R40L3R18L14L29R9R19L2R12R19R20R2R27L17R5R22R30R10R1L42R48L26R15R18R43R44R23L6L24R35L45L3L8R43L48R50L8R8L19L12R45R29L5L13R20L15R3L33L39L38L30R2R37R31R48R18L13L36R47L37L16L29R38R27R27L27L21R16R50R12R9R36L6L4R48R39L41R5L11L47R22L20L12L26L43R19L34R1R19R44L48R8R32L36R47R8L22L18L48L32R9L42R14R32L35L36R48R42R36L4R42R44L19R1R35L17R48R23R49L27L13L5R5L14L24R35R6L20R2L50L31R16L28R39L36R44R6L1R28L38L22R13R12R46L34L39L44R49R48R8R26L9R17R6L38L26L50L31R18L42L46R15L26R43L8L41L30R33R33R46L37R44L35R1L1R1L15L43L16L33L22L15L32L43R43R30R49R2L26R46R18L2R39R1R28L2L42R42L2L21L41R41L1L3R37R6R21L29R8L26R46L36R22L14L23L12L12L9L42R17R41R26L3L27L25L11L6L32L1R41L11R40R47R35L45R15R38L1L1R28R12R17L43L14R17L17R4L42L46R43L46R41R32L12R22R4L25L23R14L5L43R22L40R4R50R36R24L26R27R15L34R44R1R43R43R7R7L10L4R27L12R29R5L48L26L20R26L9L13L32L48R34L29R33R22L35R42R41R19R37L16R24L33R5L10R14R28L5L46R42L11L16L44R5R27L21L38R36R33R45R10L40R35L37R3L37L37L6R27R41L45L21R1L2L5R15L33R26L14L10L29R32L24L7L9L3R49L32R37R23L10R42L33L16L18L13L34R23R17R46L45L29L18L6R34R29L34L10L27L27L47R27L37R28L10R14R48L19L11R24R24L38L6R23R13R19L11L34L19L23R12L5R26L22R36L16R47L23R24R29R40L43R15R9L2L45L35R32R27L41L45R17L17R17L9L29L22R26L19R47R4L2L23L37R40L3L28R29R9L24L14R50R43L18L19R15L27L46L47L31L50L44L29R14R8R17R12R8R16R35R11R41R11L2L43L35L15L14R10R44R25R45L42L29L27L14R10R30R26L5L23R46R31L43L44R29R22L24L34L14R36R15L16R20R31R4L14R45L24L22R50R10L10L36L35R11R12L29R33R4R18R16R34L44R33R10L5L23R48R19R18L25L23L36R27L1R28R49R43L24L22L40R5L26R22L8R49L48R18R21L43L43L43R26R21R46L21R8L48L5R24R16R27L16R50L41R13R9L7R24R35R23L7R14L16R39L7R22R34R36R3R48L22R22R29L22L27L8L18L30L30L42R42R47R12R49R8L5R5L47L45R7R36L31L39R23L9R18L5L38L49R4R6R22R17R4L34R40R48R23L37L6L43L37R10L30R39L22L11L30L30L24L31L30L34L26L17R39R23L31L24L30R1L23L9R21R40R27R42L24L48R34L15L17R39R11R30R27L28L38L14R26L20L41R20L48L33R41R26L1L34L43L20L12L38L32R8L17L23R46L24R13R29R1R13L33R21R8R36R35R7R24L38L39L27L49L4R28R31L49L45L3R6R17L43R21L8L10L46R17R43R45L12R25R18L41L28L46L38L4R46R22R25L26L11R48L1L10R39R41R13R48L10R40R45R35L45R24R30L29L14L12R9R12L33R13L21R23L22L32L6R34L27L42L31R8L24L23L34L27L37R27R4L20R2L22R17R29L1L25L30R11R6L44R8L14R11L32L28L34L4R17L29R24L20R46R12R14R43R46R11L35R23L12R43L46L35R48L36L25R41R46L33R43R41L32L16L1L25R17R42R44L34R6R37L49R29L21L47L45R39L46L26R2L49L49R7R36R18R39L49L45R45L10R27R13R3L10L17L14R34R22R17L49L34L24R39R37R26L28L24R2R30R40R17R46L27R11L9L20L18L41L5L31R3R45R28R6L32L34L46L4L13L29R50R15R14R26L36R48R12L13R10R29R31R47L49R9L18R50L1L2L46R33L14R21R33L44L18R9L34L39L29L17L49R6R1R41R7R12R45R13R41L24L50L35R21R5R25R2L42L24R42L31R48L4L34R48L15R43L40R30L7R24R47L42L7R44L12L30L24R5R39R26L17L46L14R15L23R4L48L8R37L27L29L24R11L37L18R38L35R8R7R36R22L35R8R18L49R41R46R24R11L47L50L15L38L38L11R39R44L36L2L40L47R39R42R11R35L9R13R36L46R36R22R42R19L20L31R7L21R11L37L6R28R3L26R12L14L47R22L8L24R47R42L29L9R36L46R41L12L2R40L32R34L15R13R21R22L44R48L26L2L47R49R6R33R28R12L39R43L25R33R10R9L14L50R5L10R9L10R46R18L25L17R9R5R4L27R25L2R14L7L48L17L50R3L28R36R47L38L13R49L9R43R5L22L22L50L7R4R5R39R21L24R6L8L42L28L18L41L13R21R20R3L6L7L20R10R33R10R49L18R2L35L16R24R4L9R17R39L44R41L16L17R18R10R35R31R25L43L29R32R4R21L38R5L16L15R11L26R38L14R41R14R4R47R1R5R31R38L7L23L25L8L48R10R46L50L27L24L43R32L28L13R26R40L41L10L14R38R45L10L26L35L17L12R31R48L25R5R26L20R38R28R46L39R36R37L44R4R48L30R24R3L4R23R41R29R29L1L47L36L41R47R20L31R35L10L12R13L37L38R29L31L23L12L47L26L31L49L3R23R48R41L38L31L27L44R26R38R17L18R38R4R9R39L18R3L12R20L1L23L16R30R16L6R44L45R26R2R50L21R15R21R14R4R18R21L1R14L18L13L40R47R3L11R50L50L42L10R32L30L8R35R33L44R50R43R2L1R14L31L32R11R22L5L27L41L43L27L29R17R21R7R12R14R38L45R21L21R48L16R6R30R28R6R16L19L45L17R45R12L20L18L13L23L35R17L39L33L29R32R35L25L28R50L7R46L14L28L20R43R47R32R9R50R47L33R31R25"""

input_data_airy = """                                                  .......#..............................................#.#..#.#..#.....#.........#.....#.............
                                                  ......................#..........................#.#.....................##.........................
                                                  ......#...#.#...........#...#..........#...........#.........................#..........#..#........
                                                  ..........#.....#.....##..#..#..............#....#..........................##.#..#......#.....##...
                                                  .......#....#...#.......#..#......#...#..........#...........................####...................
                                                  ...#.....#....#............#..#.#.....#.#................#..#........#.........#....................
                                                  ..............#...#....#....................#.#....#.##....#...#.#.#...#..........#....#............
                                                  ...........#........#.#......#.#..............................#.............#.............#....#....
                                                  ............#.........##..........##.#....##........#.......#.#.......................#...#...#.....
                                                  ...................#......#........#......#.......#....#...............................#...#......#.
                                                  ....#........................................#..#................##...........#.........#...##......
                                                  ..........................#...................#.......#.......##...#.......#...#........#...........
                                                  ........#....#...##...#.......#.....##...#..............#.................#..#.........#........#...
                                                  ..................#..........#...#...#..#...........................##...##.....#...................
                                                  ...#......#....#......#.............#.....#...........#...........................................#.
                                                  ...................#..........#..#.......#........#........#.#.....#...#............................
                                                  ..#.....................#..#....#.......#......#.................................#..............#...
                                                  ............#...........#..#..........#...........##...................#..#.............#.....#.#...
                                                  ..............##.........#.#........#.............#...#..........#.........................#.#....#.
                                                  .#............##................................#.......#......#...##...#.............#.............
                                                  ...............#............#...........#.#.............#..........................##...#...........
                                                  ...#.#...........#.......#..#............#.....#.......#....#.....#...#.........#.#.....#..........#
                                                  .#.....................#..#...........#............#........#........#....#.#.......................
                                                  ..#.......................................#...........#....#......................#..............#..
                                                  ..#..........#..#...........#..........................#..........#.........#....#......#..........#
                                                  .....#........................#......................#.#..#........#................................
                                                  #...#..................#....#..............................#......#.....................#.#.........
                                                  ...........#.............#...##..........#.......................#..#....#...#.....#..#.........#..#
                                                  .#..#..#.............##..#..............##.....#.............#......##..#.##...............#........
                                                  ........#...#...............#....#.#..........#..#........#..#..#......#.....#......................
                                                  ......................#...............#...............#............#....#....#.#....................
                                                  .#.....#.............#................................#.............................#.....#...#....#
                                                  .........#.##........#.#..#.....##.........................##..........................#............
                                                  ....#.........................#........#...........#..#....................#......#..#..........#...
                                                  ..........#...#.##...........................................................##......#..............
                                                  ...#..........#....#....#..#.....#....#...#..#....#..............#..........................#.#.....
                                                  .#.......#.#.....................#...........#..................................#.....#.......#....#
                                                  .........##.........................#...#......#....#............................#....#.............
                                                  ..................#........#.....#...............#........#.....#...................#...#........#..
                                                  ...............#........#...........#....#................#..........##......#.#....................
                                                  ....#.............#............#.........#...........................................#......#...#..#
                                                  ...............##...#.##.#.............#...#.......#..#..#...#..#...........#.....##.##...#........#
                                                  #........#...##................................##..#....................#.#.......................#.
                                                  ....#.#.......#..........#.............#.#............#........#.....##.#........#..................
                                                  ......#................##.....#.............#..#.....#.#..........#...##....#....................#..
                                                  ...###...............................#..................#.#..........#...........................#..
                                                  ...#.........#......#.#....#...........#.....#.......................#.#...#......#................#
                                                  .....#..#.#..#............#.....#........................#....#.................#..........#.....#..
                                                  ...#...........#.....#...........#.#..#....#.#...##.#......#.#.....#....#........#..................
                                                  ..#......#.#...##............#............................#.....#...........#.....................#.
                                                  ..#..............#........................##.#....
                                                  ....#............#...#....#..#....#.........#.....
                                                  ...#........#.#.#................#...............#
                                                  .#..#.........................#....#.#.....#......
                                                  ....#..........#....................#.#.##........
                                                  ....#.......#..#........................#.........
                                                  ..............#......#.........#...........#......
                                                  #......#.#............#....................#...#..
                                                  #..........#.....#................................
                                                  ..#.......##...#............................#.....
                                                  ..##........#..........#...##.........#..........#
                                                  ................#....#........#.....#.............
                                                  ....#..#.............#.............#..............
                                                  ..#.........#.......#...##.....#.......#...#......
                                                  ..........#.................#......#...#..........
                                                  ..........................#.......................
                                                  ...#...#.........#.....#.......#............#.....
                                                  ............................#..........##........#
                                                  ....#...................#.......................#.
                                                  ...#.....#.....#........................#.........
                                                  ...................................#......#.#.....
                                                  .......##.#...........###........................#
                                                  ...#.............#.#..........#............#......
                                                  ................#..#.....#.............#..........
                                                  .#......##.#......#.#..#.......................#..
                                                  .#...........#............#....#..................
                                                  ......#...#.#............#...#...#...#............
                                                  ...........##.......##.......#....................
                                                  #..........#......#..................#............
                                                  ......#..................#..........#............#
                                                  ......................#........#..........#.......
                                                  .......#......#.................#.................
                                                  ...................#.#.........#..........#.......
                                                  .......#.#..........................#..#..........
                                                  .......#..........#...............................
                                                  ..................#.........#................##..#
                                                  ##..........#.......#.........#...#......#........
                                                  ..................#.........#.....................
                                                  .....#......#................#....................
                                                  ...............................#..#......#........
                                                  ..........................#....#..................
                                                  .....#..#..#..........#......#....................
                                                  ........##...#..#......#..#...............#.......
                                                  ##.......#..........#...#..........##......#......
                                                  #.............#...............................#...
                                                  .#.............#..................................
                                                  ..................................................
                                                  .#...#...#..#.............#.....#......#..........
                                                  .#..#.....#..............#.##....#................
                                                  ...................#.#.........#..................
..#..##......##.#........#.#....#.......#................#..........................................
.....#.......#.......#........#.#.....#.............#..............#..............#.................
..........#....#...#...........................##...............................##.#...............#
..........#.............#.................##..............#.................................#.......
.#..#.............................................#...##..#.....#.......#.#..##...#.................
##.##...................................#...................................#.............#.........
....#.........#.........#............#..#.........#...........#..............#..........#......#....
.....................#...#........................#...........#.....#...............................
...#......#.....#....#.....#..........#.........................##.#........#.......................
.#.......#.......................##...................#.#..#...#.......................##...........
.#...........#.............#...#......................#..#...........#.....#........#......#........
....................#....##...#...............##.#....#.....................#.#...............#.....
.......#..#..#.....#...........#......#...........................#..............#...#......#.......
.....#.......#...................##..............................#...............#................#.
...#...........#...........##.#.......#....##..............#.##...............#.......#...#.#......#
...............#.........#....##........#....##.......#...................##.................#...#..
...........#.............#.........#..#.#..........#...#.....#............#.........................
...................#......#.................#....................#...#...#...............#..#.......
....#.........................................##...#..#.....................#....#..................
.................#...#.....#........................#........#.......#........#.....................
.............#........................#.#.....................#..........#..............#....#.#....
..#........#.#...............#..#.....#...#...............#..#........................#.#....#......
#......#........#....#.....#.#..........##.....#.....#..........................##..#.#.#........#.#
.......#.....#..#...........#..#.#....#.......#...........#...........#..................#..........
..............#............................................................#...#.....##......#......
..#....................................#..........#.#....##.....#...#...........#.....#.............
..................#...#.....................#.#.#..#..............#..#.....#...........#.....#...#..
.#.#..#.....##...........#.................#.........#.......................#.#...#.#.....#........
.....#...........................#.............#.....#.............#.....................#.......#..
....#..#...#............#.............#..#..#......#...#.................#....#....###..............
.........#.....#....#........#........#....##...#.......#...#.....#........#............#...........
##.....#...#.##................##........#......#........................#..#.....#.........#.......
........................#...........#.............................#.....#..#.................#......
.............#..#.....#..................#............#.........................#...................
............#..............#.#..#.....................#........................#..#.......#......#..
.............##........#.#......#....#.....................##.................#..#..##...........#..
......................#..................#.......................#....#.................#...........
#.....#.......#............#......#..#...#....#.#.............#.................#.....#.............
...#.......#.........................#...........##..........#..................#..#.......#.....#..
..#.#.#..............#....#..#..........................................#.#..........#.....#........
.....#..................#.#............#........................................#....#..............
.#.....#........#................................#..#...................##.#......#.................
##............#......#.#...##.............................#.......#........#........................
...............#..#......#.......#....#....................................#......#...........#....#
...........#..........#......#...#....#.....#....#..............#............#.............#........
...............#...........#....#.......................#...#...............................#.......
........#........#......#...#.................#..#..................#..................#............
...#.........#................#.....................#..##...................#....##............#.#..
...........#....#.#.....##......................#..#......#.........#...#...........................
.....###.........#................#............#...#.............................#.....#..#.......#.
.......#.......#.........#....#....##.............
.............#..##.#.......#.....#...#.........#.#
.#................#..#........#...............#..#
.....#.......#...........#.....#.....#......#.....
.#.#......#..#..........#.....#...#.#.............
.......##....#............#..#..............#.....
.#.........#..........#.......#........#..........
...#.....#.#.#..........##...................#....
.#..#..#..#...#.#....#.......#.................#..
........#......#......#..#..#.....#.....#..#......
..................................................
..................................................
.#..#.............#.........#....#..###...........
#.#....#......................#.#....#...........#
..................#..................#....#.......
...........#.........#....#..#...#................
#...........#..........#............#....#.#......
.#....##.....#......#.............................
....#.....#........#......#..#................#.#.
...#............#....#.#........................#.
..#..................#............................
....#.....#.................#......##.............
......................#...........................
#......#.#........#...........#.....#.............
...#................#............#..#..#......#..#
..............##................#.#......##.......
.................#....#.#.#..#.......#........#...
.......#........#......##...........#......#......
.#...............#....#...........#.#.............
....#..............##.#.....#....#.#...........#..
.......................##.....#...#..............#
..#..............................#.....#.......#..
...#......##..#...#........#..#...................
#.................................................
........#.................#...#.........##........
#..............................#..#...............
........#..#...#.....##.#........#....#..........#
#...#......#...............#..................#...
....................#.....#...................#...
.......#.......####...............................
.##...........#......#.........##.................
.#..#.............#.#...................#..##.....
........#...#...#........#.....##.................
.....#....................#.......................
......................#...........................
..........#.....#........##....#....#.............
........#............#................#...........
..#....................................#........#.
..............##.#......#...............##.#.#....
....#...#.#.#.................##.............#....

42L16R50R47L35L8L9L30L12R41L5R42L31R30L36R37L8R16R12L43L27R15R18L18L38R39R2L22R17L34R12L32L50R37L9R22L36R4L35R29L26R15L34L4L32R1R12L30R38R30L40L20L47L46R29L21R48L23L34R41L18R36R47R16L31R8L20L24L29R26L2R23L46L48L33R46R47L15R39L38L15L3R36L39L40L5L30R27R42L12L3R42L1R28R42L50R8R15R39L29L38R10L37R49L25L45R3L44R29L16R30L48L29L22L42R44L36R12R38R44R29L18L37R39L47L4L49L18R32R34L45L15R11R28L21R35L20L40L8L2R16L21L30R9R21L44L33R40L50R15L38R49L40L13L3L5L16L23L26L27L12R41L40R33L15L28L43R16R4R9R7L16R48R4R46L5R29R7R35R17L30L32R37L19L49R45R4L43R28R1L23L33L11R31R30R30R47R25R9R16L43L40L8L9L12R47R32R33R36L8L2L26R29R5R32R11R45R14L31R30L10L16R27R26R10R2R50R37L9L12L13R38R27R21L30L21R37R5L44L1L33R43R5R31R30R11L38L9L35L21R37R7R50L26R18L32R21R45R22R29L40R36L27R15R27R38R27R12R14R23L6L33L4R4L38R17L38R44L33L38L43R14L11L47L18R2R40R26L30R10L5L28L14L23L46L29L1L35L24R33L14R33R29L37R6L49L33R6L37R4L7L33L29R12L28R24L1R20R36L8L34L17L20R41R1R34R3L38R20R35R21L7R34L44L9R39L30R22L36L45L4R49R39R21L22L29R5L5L40L17L40R40R5L45R37R42R42R15L38L17L4R30R5R16R42R12L22R24R12L45R49R49L37R10R16L27L9R19R13R42R46L9L37R47L11L23R19R25L29R28L36L13R24R25L20R12L44L11L42R47L8L20L35R10L49R22L33L25R46L29L19R40R15L24L33R29R48L39R30L25L8L26L26L10L12R50L10L32R6R19R15L48L40L40L33R19L20L9R44R15R22R18L19R26R7L43L38L39L37R11L13R34R36R6R42R8R32R36R17R28R48L20L50R38R43L18L31L49R15L41R31L6R38L33L4L38R49R6L11L16L31L19R18R1R4R16R46L13R23L46L45L11L40L18L21L38L33R22R16L47L10L48R32R16R5L2R21R22R33R32L18L41L40R46R2L29R24L24R14R42L44L24R32R5R16R5L29R40R32L30L19L47R39L48R35R26L47R40L9R47R43R50L1R47R10L43R39L37L24L7R33L38R37R10R39L13L3R4R29R25R10R43R35L40L41R36R31L11L18R14R41R23R32L40R14L45L22L42L38R43R11L43L16R48L1L6R2R2L5L18R21L42R38L10R48L4R32R38L33R16R33L23L29L43R19R41R15L11L1L43R33R49L43R22R20L18L30R18L43R41R6L40L50R6R48R16L27L4L32R27R4R10R13R41L47R30R44L19L28R38R35R5L26R46R10R19L38R40R9R50R43R7R36L29L20R5L16L37L24L46L6L49L2L40L39L18L9R46L42R48L8L47R10R9R48L26R40L23L42L25R30R17R33R4R40R46R23L15R2L47R40L3R18L14L29R9R19L2R12R19R20R2R27L17R5R22R30R10R1L42R48L26R15R18R43R44R23L6L24R35L45L3L8R43L48R50L8R8L19L12R45R29L5L13R20L15R3L33L39L38L30R2R37R31R48R18L13L36R47L37L16L29R38R27R27L27L21R16R50R12R9R36L6L4R48R39L41R5L11L47R22L20L12L26L43R19L34R1R19R44L48R8R32L36R47R8L22L18L48L32R9L42R14R32L35L36R48R42R36L4R42R44L19R1R35L17R48R23R49L27L13L5R5L14L24R35R6L20R2L50L31R16L28R39L36R44R6L1R28L38L22R13R12R46L34L39L44R49R48R8R26L9R17R6L38L26L50L31R18L42L46R15L26R43L8L41L30R33R33R46L37R44L35R1L1R1L15L43L16L33L22L15L32L43R43R30R49R2L26R46R18L2R39R1R28L2L42R42L2L21L41R41L1L3R37R6R21L29R8L26R46L36R22L14L23L12L12L9L42R17R41R26L3L27L25L11L6L32L1R41L11R40R47R35L45R15R38L1L1R28R12R17L43L14R17L17R4L42L46R43L46R41R32L12R22R4L25L23R14L5L43R22L40R4R50R36R24L26R27R15L34R44R1R43R43R7R7L10L4R27L12R29R5L48L26L20R26L9L13L32L48R34L29R33R22L35R42R41R19R37L16R24L33R5L10R14R28L5L46R42L11L16L44R5R27L21L38R36R33R45R10L40R35L37R3L37L37L6R27R41L45L21R1L2L5R15L33R26L14L10L29R32L24L7L9L3R49L32R37R23L10R42L33L16L18L13L34R23R17R46L45L29L18L6R34R29L34L10L27L27L47R27L37R28L10R14R48L19L11R24R24L38L6R23R13R19L11L34L19L23R12L5R26L22R36L16R47L23R24R29R40L43R15R9L2L45L35R32R27L41L45R17L17R17L9L29L22R26L19R47R4L2L23L37R40L3L28R29R9L24L14R50R43L18L19R15L27L46L47L31L50L44L29R14R8R17R12R8R16R35R11R41R11L2L43L35L15L14R10R44R25R45L42L29L27L14R10R30R26L5L23R46R31L43L44R29R22L24L34L14R36R15L16R20R31R4L14R45L24L22R50R10L10L36L35R11R12L29R33R4R18R16R34L44R33R10L5L23R48R19R18L25L23L36R27L1R28R49R43L24L22L40R5L26R22L8R49L48R18R21L43L43L43R26R21R46L21R8L48L5R24R16R27L16R50L41R13R9L7R24R35R23L7R14L16R39L7R22R34R36R3R48L22R22R29L22L27L8L18L30L30L42R42R47R12R49R8L5R5L47L45R7R36L31L39R23L9R18L5L38L49R4R6R22R17R4L34R40R48R23L37L6L43L37R10L30R39L22L11L30L30L24L31L30L34L26L17R39R23L31L24L30R1L23L9R21R40R27R42L24L48R34L15L17R39R11R30R27L28L38L14R26L20L41R20L48L33R41R26L1L34L43L20L12L38L32R8L17L23R46L24R13R29R1R13L33R21R8R36R35R7R24L38L39L27L49L4R28R31L49L45L3R6R17L43R21L8L10L46R17R43R45L12R25R18L41L28L46L38L4R46R22R25L26L11R48L1L10R39R41R13R48L10R40R45R35L45R24R30L29L14L12R9R12L33R13L21R23L22L32L6R34L27L42L31R8L24L23L34L27L37R27R4L20R2L22R17R29L1L25L30R11R6L44R8L14R11L32L28L34L4R17L29R24L20R46R12R14R43R46R11L35R23L12R43L46L35R48L36L25R41R46L33R43R41L32L16L1L25R17R42R44L34R6R37L49R29L21L47L45R39L46L26R2L49L49R7R36R18R39L49L45R45L10R27R13R3L10L17L14R34R22R17L49L34L24R39R37R26L28L24R2R30R40R17R46L27R11L9L20L18L41L5L31R3R45R28R6L32L34L46L4L13L29R50R15R14R26L36R48R12L13R10R29R31R47L49R9L18R50L1L2L46R33L14R21R33L44L18R9L34L39L29L17L49R6R1R41R7R12R45R13R41L24L50L35R21R5R25R2L42L24R42L31R48L4L34R48L15R43L40R30L7R24R47L42L7R44L12L30L24R5R39R26L17L46L14R15L23R4L48L8R37L27L29L24R11L37L18R38L35R8R7R36R22L35R8R18L49R41R46R24R11L47L50L15L38L38L11R39R44L36L2L40L47R39R42R11R35L9R13R36L46R36R22R42R19L20L31R7L21R11L37L6R28R3L26R12L14L47R22L8L24R47R42L29L9R36L46R41L12L2R40L32R34L15R13R21R22L44R48L26L2L47R49R6R33R28R12L39R43L25R33R10R9L14L50R5L10R9L10R46R18L25L17R9R5R4L27R25L2R14L7L48L17L50R3L28R36R47L38L13R49L9R43R5L22L22L50L7R4R5R39R21L24R6L8L42L28L18L41L13R21R20R3L6L7L20R10R33R10R49L18R2L35L16R24R4L9R17R39L44R41L16L17R18R10R35R31R25L43L29R32R4R21L38R5L16L15R11L26R38L14R41R14R4R47R1R5R31R38L7L23L25L8L48R10R46L50L27L24L43R32L28L13R26R40L41L10L14R38R45L10L26L35L17L12R31R48L25R5R26L20R38R28R46L39R36R37L44R4R48L30R24R3L4R23R41R29R29L1L47L36L41R47R20L31R35L10L12R13L37L38R29L31L23L12L47L26L31L49L3R23R48R41L38L31L27L44R26R38R17L18R38R4R9R39L18R3L12R20L1L23L16R30R16L6R44L45R26R2R50L21R15R21R14R4R18R21L1R14L18L13L40R47R3L11R50L50L42L10R32L30L8R35R33L44R50R43R2L1R14L31L32R11R22L5L27L41L43L27L29R17R21R7R12R14R38L45R21L21R48L16R6R30R28R6R16L19L45L17R45R12L20L18L13L23L35R17L39L33L29R32R35L25L28R50L7R46L14L28L20R43R47R32R9R50R47L33R31R25"""

def solve_b(inp=input_data):
    # inp = inp.splitlines()
    map, pathr = inp.split("\n\n")
    grid = {}
    for y, row in enumerate(map.split("\n")):
        for x, tile in enumerate(row):
            if tile == " ":
                continue
            grid[complex(x, y)] = tile

    path = []
    i = 0
    for (n, r) in re.findall("(\d+)([LR])", pathr):
        path.append(int(n))
        path.append(r)

    dir = complex(1, 0)
    pos = complex(min(c.real for (c, tile) in grid.items() if c.imag == 0 and tile != "#"), 0)
    rots = {"R": 1j, "L": -1j}
    # sameside = lambda p1, p2: p1.real // 50 == p2.real // 50 and p1.imag // 50 == p2.imag // 50

    htr, vtr = {}, {}
    htr.update({p1: (p2, 1) for p1, p2 in zip(ip(50, 50 + 49j), ip(149j, 100j))})
    htr.update({p2: (p1, 1) for p1, p2 in zip(ip(50, 50 + 49j), ip(149j, 100j))})

    vtr.update({p1: (p2, 1) for p1, p2 in zip(ip(50, 99), ip(150j, 199j))})
    htr.update({p2: (p1, 1j) for p1, p2 in zip(ip(50, 99), ip(150j, 199j))})

    vtr.update({p1: (p2, -1j) for p1, p2 in zip(ip(100, 149), ip(199j, 199j + 49))})
    vtr.update({p2: (p1, 1j) for p1, p2 in zip(ip(100, 149), ip(199j, 199j + 49))})

    htr.update({p1: (p2, -1) for p1, p2 in zip(ip(149, 149+ 49j), ip(99 + 149j, 99 + 100j))})
    htr.update({p2: (p1, -1) for p1, p2 in zip(ip(149, 149+ 49j), ip(99 + 149j, 99 + 100j))})

    vtr.update({p1: (p2, -1) for p1, p2 in zip(ip(100+49j, 149+ 49j), ip(99 + 50j, 99 + 99j))})
    htr.update({p2: (p1, -1j) for p1, p2 in zip(ip(100+49j, 149+ 49j), ip(99 + 50j, 99 + 99j))})

    htr.update({p1: (p2, 1j) for p1, p2 in zip(ip(50+50j, 50+99j), ip(0 + 100j, 49 + 100j))})
    vtr.update({p2: (p1, 1) for p1, p2 in zip(ip(50+50j, 50+99j), ip(0 + 100j, 49 + 100j))})

    vtr.update({p1: (p2, -1) for p1, p2 in zip(ip(50+149j, 99+149j), ip(49 + 150j, 49 + 199j))})
    htr.update({p2: (p1, -1j) for p1, p2 in zip(ip(50+149j, 99+149j), ip(49 + 150j, 49 + 199j))})

    db = False
    for ins in path:
        print(dir, pos, ins)
        if isinstance(ins, int):
            for _ in range(ins):
                # print(dir, pos, ins)
                if pos + dir not in grid:
                    # if db:
                    #     exit()
                    print(f"PRE WRAP {pos} = {pos.imag +1, pos.real +1}")
                    newpos, newdir = (vtr if dir.imag else htr)[pos]
                    if grid[newpos] == "#":
                        # print(f"ABORTING WRAP DUE TO WALL")
                        break
                    else:
                        pos = newpos
                        dir = newdir
                        print(f"POST WRAP {pos} = {pos.imag +1, pos.real +1}")
                        if pos == 99 + 107j:
                            pos = 93 + 107j
                            break
                        #     print(grid[99 + 102j])
                            # db = True
                elif grid[pos + dir] == "#":
                    break
                else:
                    pos += dir
        else:
            dir *= rots[ins]
        # if db:
        #     print(dir, pos)

    return (pos.real + 1) * 4 + (pos.imag + 1) * 1000 + {complex(1, 0): 0, complex(0, -1): 1, complex(-1, 0): 2, complex(0, 1): 3}[dir]

tests = {
    """        ...#
        .#..
        #...
        ....
...#.......#
........#...
..#....#....
..........#.
        ...#....
        .....#..
        .#......
        ......#.

10R5L5R10L4R5L5""" : [6032]
}

# test(tests, solve_a, 0)
# a = solve_a(input_data4)
# print(f"Part 1: {a}\n")
# submit(int(a) if isinstance(a, float) else a, part="a", day=day, year=2022)

# test(tests, solve_b, 1)
b = solve_b(input_data4)
print(f"Part 2: {b}")
# submit(int(b) if isinstance(b, float) else b, part="b", day=day, year=2022)
#
#
# import time
# t1 = time.time_ns()
# for i in range(times := 1000):
#     solve_b()
# t2 = time.time_ns()
# print(f"Time: {(t2-t1)/(1000000*times)} ms")